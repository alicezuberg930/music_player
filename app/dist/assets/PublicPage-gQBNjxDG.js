import{j as e,q as t,Y as r,Z as a}from"./radix-ui-vendor-Buyt95xJ.js";import{c as n,o as s,D as l,a as i,u as c,L as o,T as d,b as u,s as h,d as x,e as m,f,H as p,E as j,g,h as v,i as y,j as w,C as b,k,B as N,M as C,l as M,m as L,S as E,X as S,n as A,p as z,q as _,r as R,t as T,v as $,w as I,x as P,y as q,z as O,U as H,A as D,F as U,G as F,I as V,J as B,K as W,N as K,O as X,P as Z,Q as G,R as J,V as Q,W as Y}from"./index-Bgm4bWT9.js";import{c as ee,r as te,u as re,R as ae,L as ne,k as se,O as le}from"./react-vendor-CeLBa8wC.js";import"./redux-vendor-DaFkugUR.js";
/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=n("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ce=n("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),oe=n("circle-pause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),de=n("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),ue=n("mic-vocal",[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]]),he=n("repeat-1",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]]),xe=n("repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),me=n("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),fe=n("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]),pe=n("skip-back",[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]]),je=n("skip-forward",[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]]),ge=n("spotlight",[["path",{d:"M15.295 19.562 16 22",key:"31jsb7"}],["path",{d:"m17 16 3.758 2.098",key:"121ar7"}],["path",{d:"m19 12.5 3.026-.598",key:"19ukd3"}],["path",{d:"M7.61 6.3a3 3 0 0 0-3.92 1.3l-1.38 2.79a3 3 0 0 0 1.3 3.91l6.89 3.597a1 1 0 0 0 1.342-.447l3.106-6.211a1 1 0 0 0-.447-1.341z",key:"lwb9l9"}],["path",{d:"M8 9V2",key:"1xa0v7"}]]),ve=n("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),ye=n("volume-1",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]]),we=n("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),be=n("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),ke="audio-files";let Ne=null;const Ce=async()=>(Ne??=s("music-player-audio",1,{upgrade(e){e.objectStoreNames.contains(ke)||e.createObjectStore(ke)}}),Ne);function Me({...t}){return e.jsx(l.Root,{"data-slot":"drawer",...t})}function Le({...t}){return e.jsx(l.Trigger,{"data-slot":"drawer-trigger",...t})}function Ee({...t}){return e.jsx(l.Portal,{"data-slot":"drawer-portal",...t})}function Se({className:t,...r}){return e.jsx(l.Overlay,{"data-slot":"drawer-overlay",className:i("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function Ae({className:t,children:r,...a}){return e.jsxs(Ee,{"data-slot":"drawer-portal",children:[e.jsx(Se,{}),e.jsxs(l.Content,{"data-slot":"drawer-content",className:i("group/drawer-content bg-background fixed z-50 flex h-auto flex-col ","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...a,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),r]})]})}function ze({className:t,...r}){return e.jsx("div",{"data-slot":"drawer-header",className:i("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...r})}function _e({className:t,...r}){return e.jsx(l.Title,{"data-slot":"drawer-title",className:i("text-foreground font-semibold",t),...r})}function Re({className:t,...r}){return e.jsx(l.Description,{"data-slot":"drawer-description",className:i("text-muted-foreground text-sm",t),...r})}const Te=({drawerTrigger:t,audioRef:r})=>{const{currentSong:a}=c(e=>e.music),[n,s]=ee.useState(""),[l,i]=ee.useState(0),u=ee.useRef(null),h=ee.useRef(null);return ee.useEffect(()=>{if((async()=>{if(a?.lyricsFile){const e=await fetch(a.lyricsFile),t=await e.text();s(t.replaceAll("\r\n","\n"))}})(),r.current){const e=setInterval(()=>{r.current&&i(1e3*r.current.currentTime)},1500);return()=>clearInterval(e)}},[r.current]),ee.useEffect(()=>{if(u.current&&h.current){const e=u.current.clientHeight,t=u.current.offsetTop-10*e;h.current.scrollTo({top:t,behavior:"smooth"})}},[l]),e.jsxs(Me,{children:[e.jsx(Le,{asChild:!0,children:t}),e.jsx(Ae,{className:"bg-white/70 min-h-[calc(100vh-96px)] backdrop-blur-md",children:e.jsxs("div",{className:"mx-auto w-full h-screen max-w-6xl relative",children:[e.jsxs(ze,{children:[e.jsx(_e,{children:"Lời bài hát"}),e.jsxs(Re,{children:[a?.title," - ",a?.artistNames]})]}),e.jsx("div",{ref:h,className:"h-[65vh] overflow-auto px-4",children:n.length>0?e.jsx(o,{lrc:n,currentMillisecond:l,lineRenderer:({index:t,active:r,line:a})=>e.jsx(d,{ref:r?u:null,variant:"h4",className:"my-8 text-center transition-colors duration-300 "+(r?"text-main-500":"text-gray-400"),children:a.content},t)}):e.jsx(d,{className:"text-center text-gray-400",children:"Không có lời bài hát"})})]})})]})},$e=()=>{const t=u(),{showSideBarRight:r}=c(e=>e.app),{currentSong:a,isPlaying:n,currentPlaylistSongs:s}=c(e=>e.music),[l,i]=te.useState(!1),[o,L]=te.useState(0),[E,S]=te.useState(50),[A,z]=te.useState(!0),_=te.useRef(!1),R=te.useRef(0),T=te.useRef(null),$=te.useRef(null),I=te.useRef(null),P=te.useRef(null),q=te.useRef(!1),O=te.useMemo(()=>{if(!a)return;const e=s.findIndex(e=>e.id===a.id);return-1===e?void 0:s[e+1]},[a,s]),H=e=>{if(!$.current||!I.current||!T.current)return;const t=$.current.getBoundingClientRect(),r=(e-t.left)/t.width*100,n=Math.max(0,Math.min(100,Math.round(r)));T.current.style.cssText=`right: ${100-n}%`,a?.duration&&(I.current.currentTime=a.duration*n/100)},D=()=>{q.current=!1},U=te.useCallback(()=>{if(s.length>0)for(let e=0;e<s.length;e++)if(s[e].id===a?.id){s[e+1]&&(t(h(s[e+1])),I.current?.play());break}},[s,a,t]),F=te.useCallback(()=>{if(s.length>0)for(let e=0;e<s.length;e++)if(s[e].id===a?.id){s[e-1]&&(t(h(s[e-1])),I.current?.play());break}},[s,a,t]),V=te.useCallback(async()=>{I.current&&(n&&!I.current.paused?(t(x(!1)),I.current.pause()):!n&&I.current.paused&&(t(x(!0)),await I.current.play()))},[n,t]),B=()=>{let e;const r=I.current;if(!r?.src)return;const n=()=>{P.current.innerText=k(Math.floor(r.currentTime));let t=Math.round(r.currentTime/a.duration*1e4)/100;T.current&&(T.current.style.cssText=`right: ${100-t}%`),e=requestAnimationFrame(n)},s=()=>e=requestAnimationFrame(n),l=()=>cancelAnimationFrame(e),i=()=>{l(),_.current?I.current&&I.current.play():R.current>0?1===R.current?I.current&&(I.current.currentTime=0,I.current.play()):U():(t(x(!1)),r.pause())};return r.addEventListener("play",s),r.addEventListener("pause",l),r.addEventListener("ended",i),()=>{r.removeEventListener("play",s),r.removeEventListener("pause",l),r.removeEventListener("ended",i),cancelAnimationFrame(e)}},W=()=>{z(!1),I.current?.play().then(e=>t(x(!0))).catch(e=>console.log("Auto play was prevented because user didnt interact with the document"))},K=async()=>{if(t(x(!1)),P.current&&(P.current.innerText="00:00"),T.current&&(T.current.style.cssText="right: 100%"),a?.stream){z(!0);await(async e=>{try{const t=await Ce();return!!(await t.get(ke,e))}catch(t){return console.error(`Error checking cache for song ${e}:`,t),!1}})(a.id)||await(async(e,t)=>{try{const r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch audio: ${r.statusText}`);const a=await r.blob(),n=await Ce();return await n.put(ke,{songId:e,blob:a,url:t,cachedAt:Date.now()},e),console.log(`Audio cached successfully for song: ${e}`),!0}catch(r){return console.error(`Error caching audio for song ${e}:`,r),!1}})(a.id,a.stream);let e=await(async e=>{try{const t=await Ce(),r=await t.get(ke,e);if(r){const t=URL.createObjectURL(r.blob);return console.log(`Audio retrieved from cache for song: ${e}`),t}return null}catch(t){return console.error(`Error retrieving audio from cache for song ${e}:`,t),null}})(a.id);e&&(I.current=new Audio(e),I.current.load(),I.current.volume=E/100,I.current.oncanplaythrough=W,B())}};return te.useEffect(()=>(K(),()=>{I.current&&(I.current.oncanplaythrough=null,I.current.pause(),I.current=null)}),[a]),te.useEffect(()=>{const e=e=>{if("Space"===e.code&&e.target instanceof HTMLElement){const t=e.target.tagName.toLowerCase();if("input"===t||"textarea"===t||e.target.isContentEditable)return;e.preventDefault(),V()}},t=e=>{if(("ArrowLeft"===e.code||"ArrowRight"===e.code)&&e.target instanceof HTMLElement){const t=e.target.tagName.toLowerCase();if("input"===t||"textarea"===t||e.target.isContentEditable)return;e.preventDefault(),"ArrowLeft"===e.code&&F(),"ArrowRight"===e.code&&U()}};return globalThis.addEventListener("keydown",e),globalThis.addEventListener("keydown",t),()=>{globalThis.removeEventListener("keydown",e),globalThis.removeEventListener("keydown",t)}},[n,V,F,U]),te.useEffect(()=>{I.current&&(I.current.volume=E/100)},[E]),te.useEffect(()=>{t(m()),_.current=l},[l]),te.useEffect(()=>{R.current=o},[o]),te.useEffect(()=>{I.current&&I.current.paused&&n&&I.current.play(),!I.current||I.current.paused||n||I.current.pause()},[n]),e.jsx("div",{className:"fixed w-full z-20 h-24 content-center bg-main-400 select-none border-t border-main-500/20 shadow-up",children:e.jsxs("div",{className:"flex justify-between px-4",children:[e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex",children:[e.jsx(f.LazyLoadImage,{src:a?.thumbnail,effect:"blur",alt:"thumbnail",className:"w-16 h-16 object-cover"}),e.jsxs("div",{children:[e.jsx(d,{className:"font-semibold text-gray-600 line-clamp-2 text-ellipsis max-w-40",children:a?.title}),e.jsx(d,{className:"text-gray-500 line-clamp-2 text-ellipsis max-w-40 m-0 lg:text-xs",children:a?.artistNames})]}),e.jsx(p,{size:20}),e.jsx(j,{size:20})]}),e.jsxs("div",{className:"flex flex-1 items-center gap-4 flex-col",children:[e.jsxs("div",{className:"flex gap-8 items-center",children:[e.jsxs(g,{children:[e.jsx(v,{asChild:!0,className:`cursor-pointer ${l&&"text-purple-600"}`,onClick:()=>i(e=>!e),children:e.jsx(fe,{size:20})}),e.jsx(y,{children:"Bật phát ngẫu nhiên"})]}),e.jsx("span",{className:""+(s.length?"cursor-pointer":"text-gray-500"),children:e.jsx(pe,{size:20,onClick:F})}),e.jsx("span",{onClick:V,className:"hover:text-main-500",children:A?e.jsx(w,{strokeColor:"#0E8080",width:42,height:42}):n?e.jsx(oe,{size:42}):e.jsx(b,{size:42})}),e.jsxs(g,{children:[e.jsx(v,{asChild:!0,children:e.jsx("span",{className:""+(s.length?"cursor-pointer":"text-gray-500"),children:e.jsx(je,{size:20,onClick:U})})}),O&&e.jsxs(y,{children:[e.jsx(d,{className:"font-semibold",children:"Phát tiếp theo"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(f.LazyLoadImage,{src:O.thumbnail,effect:"blur",alt:"thumbnail",className:"w-10 h-10 object-cover rounded-md"}),e.jsxs("div",{children:[e.jsx(d,{className:"m-0 text-gray-400",children:O.title}),e.jsx(d,{className:"m-0 text-gray-400",children:O.artistNames})]})]})]})]}),e.jsxs(g,{children:[e.jsx(v,{asChild:!0,className:`cursor-pointer ${o&&"text-purple-600"}`,onClick:()=>L(2===o?0:o+1),children:1===o?e.jsx(he,{size:20}):e.jsx(xe,{size:20})}),e.jsx(y,{children:"Phát lại tất cả bài hát"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-3 text-sm",children:[e.jsx(d,{ref:P,className:"font-semibold text-gray-500 m-0",children:"00:00"}),e.jsx("div",{className:"relative h-1 hover:h-2 bg-[#0000001a] w-3/5 rounded-full cursor-pointer",onClick:e=>{H(e.clientX)},onMouseDown:e=>{q.current=!0,H(e.clientX)},onMouseMove:e=>{q.current&&H(e.clientX)},onMouseUp:D,onMouseLeave:D,ref:$,children:e.jsx("div",{ref:T,className:"absolute top-0 left-0 bottom-0 h-full bg-main-500 rounded-full"})}),e.jsx(d,{className:"font-semibold text-gray-500 m-0",children:k(a?.duration??0)})]})]}),e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex justify-end",children:[e.jsx(Te,{drawerTrigger:e.jsx(ue,{size:20}),audioRef:I}),e.jsx(N,{size:"icon-lg",variant:"ghost",onClick:()=>S(0===E?50:0),children:E>=50?e.jsx(we,{}):0===E?e.jsx(be,{}):e.jsx(ye,{})}),e.jsx("input",{type:"range",step:1,min:0,max:100,onChange:e=>S(Number(e.target.value)),value:E,className:"h-1 hover:h-2"}),e.jsx(N,{className:"text-white",size:"lg",onClick:()=>t(M(!r)),children:e.jsx(C,{})})]})]})})},Ie=()=>{const{translate:t}=L(),r=re(),[a,n]=te.useState("");return e.jsx("div",{className:"max-w-[440px] w-full",children:e.jsx("div",{className:"bg-[#ffffff54] text-gray-500 rounded-3xl py-2",children:e.jsxs("div",{className:"flex w-full",children:[e.jsx("div",{className:"pl-4 self-center",children:e.jsx(E,{})}),e.jsx("input",{type:"text",className:"outline-none px-4 w-full bg-transparent",placeholder:t("search_placeholder"),onKeyUp:e=>(e=>{"Enter"===e.code&&e.currentTarget.value.length>2&&r({pathname:"search/all",search:"?q="+e.currentTarget.value})})(e),onChange:e=>{n(e.target.value)},value:a}),e.jsx("div",{className:(a?"block":"hidden")+" self-center pr-4",onClick:()=>n(""),children:e.jsx(S,{})})]})})})};function Pe(...e){const t=e[0];if(1===e.length)return t;const r=()=>{const r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const a=r.reduce((t,{useScope:r,scopeName:a})=>({...t,...r(e)[`__scope${a}`]}),{});return te.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}var qe=Symbol.for("react.lazy"),Oe=ae[" use ".trim().toString()];function He(e){return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===qe&&"_payload"in e&&("object"==typeof(t=e._payload)&&null!==t&&"then"in t);var t}function De(t){const r=Ue(t),a=te.forwardRef((t,a)=>{let{children:n,...s}=t;He(n)&&"function"==typeof Oe&&(n=Oe(n._payload));const l=te.Children.toArray(n),i=l.find(Ve);if(i){const t=i.props.children,n=l.map(e=>e===i?te.Children.count(t)>1?te.Children.only(null):te.isValidElement(t)?t.props.children:null:e);return e.jsx(r,{...s,ref:a,children:te.isValidElement(t)?te.cloneElement(t,void 0,n):null})}return e.jsx(r,{...s,ref:a,children:n})});return a.displayName=`${t}.Slot`,a}function Ue(e){const r=te.forwardRef((e,r)=>{let{children:a,...n}=e;if(He(a)&&"function"==typeof Oe&&(a=Oe(a._payload)),te.isValidElement(a)){const e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;if(r)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r)return e.props.ref;return e.props.ref||e.ref}(a),s=function(e,t){const r={...t};for(const a in t){const n=e[a],s=t[a];/^on[A-Z]/.test(a)?n&&s?r[a]=(...e)=>{const t=s(...e);return n(...e),t}:n&&(r[a]=n):"style"===a?r[a]={...n,...s}:"className"===a&&(r[a]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}(n,a.props);return a.type!==te.Fragment&&(s.ref=r?t(r,e):e),te.cloneElement(a,s)}return te.Children.count(a)>1?te.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var Fe=Symbol("radix.slottable");function Ve(e){return te.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===Fe}var Be=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((t,r)=>{const a=De(`Primitive.${r}`),n=te.forwardRef((t,n)=>{const{asChild:s,...l}=t,i=s?a:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),e.jsx(i,{...l,ref:n})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{});function We(){return()=>{}}var Ke="Avatar",[Xe]=function(t,r=[]){let a=[];const n=()=>{const e=a.map(e=>te.createContext(e));return function(r){const a=r?.[t]||e;return te.useMemo(()=>({[`__scope${t}`]:{...r,[t]:a}}),[r,a])}};return n.scopeName=t,[function(r,n){const s=te.createContext(n);s.displayName=r+"Context";const l=a.length;a=[...a,n];const i=r=>{const{scope:a,children:n,...i}=r,c=a?.[t]?.[l]||s,o=te.useMemo(()=>i,Object.values(i));return e.jsx(c.Provider,{value:o,children:n})};return i.displayName=r+"Provider",[i,function(e,a){const i=a?.[t]?.[l]||s,c=te.useContext(i);if(c)return c;if(void 0!==n)return n;throw new Error(`\`${e}\` must be used within \`${r}\``)}]},Pe(n,...r)]}(Ke),[Ze,Ge]=Xe(Ke),Je=te.forwardRef((t,r)=>{const{__scopeAvatar:a,...n}=t,[s,l]=te.useState("idle");return e.jsx(Ze,{scope:a,imageLoadingStatus:s,onImageLoadingStatusChange:l,children:e.jsx(Be.span,{...n,ref:r})})});Je.displayName=Ke;var Qe="AvatarImage",Ye=te.forwardRef((t,n)=>{const{__scopeAvatar:s,src:l,onLoadingStatusChange:i=()=>{},...c}=t,o=Ge(Qe,s),d=function(e,{referrerPolicy:t,crossOrigin:r}){const n=A.useSyncExternalStore(We,()=>!0,()=>!1),s=te.useRef(null),l=n?(s.current||(s.current=new window.Image),s.current):null,[i,c]=te.useState(()=>rt(l,e));return a(()=>{c(rt(l,e))},[l,e]),a(()=>{const e=e=>()=>{c(e)};if(!l)return;const a=e("loaded"),n=e("error");return l.addEventListener("load",a),l.addEventListener("error",n),t&&(l.referrerPolicy=t),"string"==typeof r&&(l.crossOrigin=r),()=>{l.removeEventListener("load",a),l.removeEventListener("error",n)}},[l,r,t]),i}(l,c),u=r(e=>{i(e),o.onImageLoadingStatusChange(e)});return a(()=>{"idle"!==d&&u(d)},[d,u]),"loaded"===d?e.jsx(Be.img,{...c,ref:n,src:l}):null});Ye.displayName=Qe;var et="AvatarFallback",tt=te.forwardRef((t,r)=>{const{__scopeAvatar:a,delayMs:n,...s}=t,l=Ge(et,a),[i,c]=te.useState(void 0===n);return te.useEffect(()=>{if(void 0!==n){const e=window.setTimeout(()=>c(!0),n);return()=>window.clearTimeout(e)}},[n]),i&&"loaded"!==l.imageLoadingStatus?e.jsx(Be.span,{...s,ref:r}):null});function rt(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}tt.displayName=et;var at=Je,nt=Ye,st=tt;function lt({className:t,...r}){return e.jsx(at,{"data-slot":"avatar",className:i("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...r})}function it({className:t,...r}){return e.jsx(nt,{"data-slot":"avatar-image",className:i("aspect-square size-full",t),...r})}function ct({className:t,...r}){return e.jsx(st,{"data-slot":"avatar-fallback",className:i("bg-muted flex size-full items-center justify-center rounded-full",t),...r})}const ot=()=>{const{user:t,signout:r}=z(),{translate:a}=L();return e.jsxs(_,{children:[e.jsx(R,{asChild:!0,children:e.jsx(lt,{children:t?.avatar?e.jsx(it,{src:t?.avatar,alt:t?.id}):e.jsx(ct,{children:t?.fullname.charAt(0)})})}),e.jsxs(T,{className:"w-56 z-100",align:"end",children:[e.jsx($,{children:a("my_account")}),e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsx(ne,{to:q.UPLOAD_MUSIC,children:a("profile")}),e.jsx(O,{children:e.jsx(H,{})})]}),e.jsxs(P,{children:[e.jsx(ne,{to:q.UPLOAD_MUSIC,children:a("settings")}),e.jsx(O,{children:e.jsx(me,{})})]}),e.jsxs(P,{children:[e.jsx(ne,{to:q.UPLOAD_MUSIC,children:a("upload_music")}),e.jsx(O,{children:e.jsx(ve,{})})]}),e.jsxs(P,{children:[e.jsx(ne,{to:q.ADD_ARTIST,children:a("add_artist")}),e.jsx(O,{children:e.jsx(ge,{})})]})]}),e.jsx(D,{}),e.jsxs(P,{onClick:r,children:[a("logout"),e.jsx(O,{children:e.jsx(de,{})})]})]})]})},dt=()=>{const{onChangeLang:t,currentLang:r,allLangs:a}=L();return e.jsxs(_,{children:[e.jsx(R,{asChild:!0,children:e.jsx(lt,{className:"rounded-sm",children:e.jsx(it,{src:r.icon,alt:r.value})})}),e.jsx(T,{className:"w-56 z-100",align:"end",children:e.jsx(I,{children:a.map(r=>e.jsxs(P,{onClick:()=>t(r.value),children:[e.jsx(d,{children:r.label}),e.jsx(O,{children:e.jsx("img",{src:r.icon,alt:r.value})})]},r.value))})})]})},ut=()=>{const{translate:t}=L();return e.jsxs(U,{children:[e.jsx(F,{asChild:!0,children:e.jsx(d,{variant:"span",className:"text-white",children:t("sign_in")})}),e.jsx(V,{className:"sm:max-w-md",children:e.jsxs(B,{defaultValue:"sign_in",children:[e.jsxs(W,{children:[e.jsx(K,{value:"sign_in",children:t("sign_in")}),e.jsx(K,{value:"sign_up",children:t("sign_up")})]}),e.jsx(X,{value:"sign_in",children:e.jsx(Z,{})}),e.jsx(X,{value:"sign_up",children:e.jsx(G,{})})]})})]})},ht=()=>{const t=re(),{isAuthenticated:r}=z();return e.jsxs("div",{className:"w-full flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex my-2 gap-2 flex-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white cursor-pointer",children:[e.jsx(ie,{onClick:()=>t(-1)}),e.jsx(ce,{onClick:()=>t(1)})]}),e.jsx(Ie,{})]}),e.jsx(dt,{}),r?e.jsx(ot,{}):e.jsx(ut,{})]})},xt=()=>{const{showSideBarRight:t,scrollTop:r}=c(e=>e.app),{currentSong:a}=c(e=>e.music),n=se(),s=u();return e.jsxs("div",{className:"w-full bg-main-300 "+(a?"h-[calc(100vh-96px)]":"h-screen"),children:[e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx(J,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[e.jsx("div",{className:`fixed top-0 right-0 left-0 z-49 transition-all duration-500 ease-in-out sm:left-20 lg:left-48 flex-none backdrop-blur-md px-4 md:px-8 ${t&&"xl:right-[330px]"} ${r?"bg-transparent":"bg-[#969696cc]"}`,children:e.jsx(ht,{})}),e.jsx("div",{className:`flex-auto overflow-y-scroll scroll-smooth transition-all duration-600 ease-in-out ${t&&"xl:mr-[330px] mr-0"}`,onScroll:e=>{(n.pathname.includes("/artist")||n.pathname.includes("/zing-chart"))&&0===e.currentTarget.scrollTop?s(Y(!0)):s(Y(!1))},children:e.jsx("div",{className:"px-4 md:px-8 mt-20 mb-6",children:e.jsx(le,{})})})]}),e.jsx(Q,{})]}),a&&e.jsx($e,{})]})};export{xt as default};
