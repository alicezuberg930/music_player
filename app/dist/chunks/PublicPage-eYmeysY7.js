import{j as e,R as a,a as s}from"./react-query-chunk-C3JHXiwa.js";import{D as r,c as t,u as n,T as l,a as i,s as c,b as d,d as o,L as u,B as x,e as h,f as m,g as j,h as f,i as p,j as g,k as w,l as v,m as b,n as N,o as y,p as k,q as C,r as T,t as L,v as z,w as E,x as S,y as M,z as R,A as _,C as P,E as q,F as A,G as U,H as D,I as F,S as I,J as B,K as O,M as V,N as $,O as H,P as K,Q as X,R as G,U as J,V as Q,W}from"../entries/index-C-JzKQZ_.js";import{k as Y,d as Z,u as ee,L as ae,l as se,O as re}from"./react-chunk-vjlR_Xb7.js";import{H as te,E as ne,v as le,w as ie,x as ce,m as de,y as oe,R as ue,z as xe,B as he,V as me,F as je,G as fe,M as pe,e as ge,X as we,U as ve,J as be,K as Ne,Q as ye,Y as ke,Z as Ce,$ as Te}from"./mix-chunk-Csz3FfyW.js";import{K as Le,M as ze,N as Ee}from"./radix-ui-chunk-BJyeau2d.js";import{c as Se,b as Me,e as Re}from"./form-chunk-DWXro7yB.js";import"./i18next-chunk-DrW9RIaf.js";import"./redux-chunk-DOlE0zqP.js";function _e({...a}){return e.jsx(r.Root,{"data-slot":"drawer",...a})}function Pe({...a}){return e.jsx(r.Trigger,{"data-slot":"drawer-trigger",...a})}function qe({...a}){return e.jsx(r.Portal,{"data-slot":"drawer-portal",...a})}function Ae({className:a,...s}){return e.jsx(r.Overlay,{"data-slot":"drawer-overlay",className:t("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...s})}function Ue({className:a,children:s,...n}){return e.jsxs(qe,{"data-slot":"drawer-portal",children:[e.jsx(Ae,{}),e.jsxs(r.Content,{"data-slot":"drawer-content",className:t("group/drawer-content bg-background fixed z-50 flex h-auto flex-col ","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",a),...n,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),s]})]})}function De({className:a,...s}){return e.jsx("div",{"data-slot":"drawer-header",className:t("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",a),...s})}function Fe({className:a,...s}){return e.jsx(r.Title,{"data-slot":"drawer-title",className:t("text-foreground font-semibold",a),...s})}function Ie({className:a,...s}){return e.jsx(r.Description,{"data-slot":"drawer-description",className:t("text-muted-foreground text-sm",a),...s})}const Be=({drawerTrigger:s,audioRef:r})=>{const{currentSong:t}=n(e=>e.music),[i,c]=a.useState(""),[d,o]=a.useState(0),u=a.useRef(null),x=a.useRef(null);return a.useEffect(()=>{if((async()=>{if(t?.lyricsFile){const e=await fetch(t.lyricsFile),a=await e.text();c(a.replaceAll("\r\n","\n"))}})(),r.current){const e=setInterval(()=>{r.current&&o(1e3*r.current.currentTime)},1500);return()=>clearInterval(e)}},[r.current]),a.useEffect(()=>{if(u.current&&x.current){const e=u.current.clientHeight,a=u.current.offsetTop-10*e;x.current.scrollTo({top:a,behavior:"smooth"})}},[d]),e.jsxs(_e,{children:[e.jsx(Pe,{asChild:!0,children:s}),e.jsx(Ue,{className:"bg-white/70 min-h-[calc(100vh-96px)] backdrop-blur-md",children:e.jsxs("div",{className:"mx-auto w-full h-screen max-w-6xl relative",children:[e.jsxs(De,{children:[e.jsx(Fe,{children:"Lời bài hát"}),e.jsxs(Ie,{children:[t?.title," - ",t?.artistNames]})]}),e.jsx("div",{ref:x,className:"h-[65vh] overflow-auto px-4",children:i.length>0?e.jsx(Y,{lrc:i,currentMillisecond:d,lineRenderer:({index:a,active:s,line:r})=>e.jsx(l,{ref:s?u:null,variant:"h4",className:"my-8 text-center transition-colors duration-300 "+(s?"text-main-500":"text-gray-400"),children:r.content},a)}):e.jsx(l,{className:"text-center text-gray-400",children:"Không có lời bài hát"})})]})})]})},Oe=()=>{const a=i(),{showSideBarRight:r}=n(e=>e.app),{currentSong:t,isPlaying:b,currentPlaylistSongs:N}=n(e=>e.music),[y,k]=s.useState(!1),[C,T]=s.useState(0),[L,z]=s.useState(50),[E,S]=s.useState(!0),M=s.useRef(!1),R=s.useRef(0),_=s.useRef(null),P=s.useRef(null),q=s.useRef(null),A=s.useRef(null),U=s.useRef(!1),D=s.useMemo(()=>{if(!t)return;const e=N.findIndex(e=>e.id===t.id);return-1===e?void 0:N[e+1]},[t,N]),F=e=>{if(!P.current||!q.current||!_.current)return;const a=P.current.getBoundingClientRect(),s=(e-a.left)/a.width*100,r=Math.max(0,Math.min(100,Math.round(s)));_.current.style.cssText=`right: ${100-r}%`,t?.duration&&(q.current.currentTime=t.duration*r/100)},I=()=>{U.current=!1},B=s.useCallback(()=>{if(N.length>0)for(let e=0;e<N.length;e++)if(N[e].id===t?.id){N[e+1]&&(a(c(N[e+1])),q.current?.play());break}},[N,t,a]),O=s.useCallback(()=>{if(N.length>0)for(let e=0;e<N.length;e++)if(N[e].id===t?.id){N[e-1]&&(a(c(N[e-1])),q.current?.play());break}},[N,t,a]),V=s.useCallback(async()=>{q.current&&(b&&!q.current.paused?(a(d(!1)),q.current.pause()):!b&&q.current.paused&&(a(d(!0)),await q.current.play()))},[b,a]),$=()=>{S(!1),q.current?.play().then(e=>a(d(!0))).catch(e=>{})};return s.useEffect(()=>((async()=>{if(a(d(!1)),A.current&&(A.current.innerText="00:00"),_.current&&(_.current.style.cssText="right: 100%"),t?.stream){S(!0),await g(t.id)||await w(t.id,t.stream);let e=await v(t.id);e&&(q.current=new Audio(e),q.current.load(),q.current.volume=L/100,q.current.oncanplaythrough=$,(()=>{let e;const s=q.current;if(!s?.src)return;const r=()=>{A.current.innerText=f(Math.floor(s.currentTime));let a=Math.round(s.currentTime/t.duration*1e4)/100;_.current&&(_.current.style.cssText=`right: ${100-a}%`),e=requestAnimationFrame(r)},n=()=>e=requestAnimationFrame(r),l=()=>cancelAnimationFrame(e),i=()=>{l(),M.current?q.current&&q.current.play():R.current>0?1===R.current?q.current&&(q.current.currentTime=0,q.current.play()):B():(a(d(!1)),s.pause())};s.addEventListener("play",n),s.addEventListener("pause",l),s.addEventListener("ended",i)})())}})(),()=>{q.current&&(q.current.oncanplaythrough=null,q.current.pause(),q.current=null)}),[t]),s.useEffect(()=>{const e=e=>{if("Space"===e.code&&e.target instanceof HTMLElement){const a=e.target.tagName.toLowerCase();if("input"===a||"textarea"===a||e.target.isContentEditable)return;e.preventDefault(),V()}},a=e=>{if(("ArrowLeft"===e.code||"ArrowRight"===e.code)&&e.target instanceof HTMLElement){const a=e.target.tagName.toLowerCase();if("input"===a||"textarea"===a||e.target.isContentEditable)return;e.preventDefault(),"ArrowLeft"===e.code&&O(),"ArrowRight"===e.code&&B()}};return globalThis.addEventListener("keydown",e),globalThis.addEventListener("keydown",a),()=>{globalThis.removeEventListener("keydown",e),globalThis.removeEventListener("keydown",a)}},[b,V,O,B]),s.useEffect(()=>{q.current&&(q.current.volume=L/100)},[L]),s.useEffect(()=>{a(o()),M.current=y},[y]),s.useEffect(()=>{R.current=C},[C]),s.useEffect(()=>{q.current&&q.current.paused&&b&&q.current.play(),!q.current||q.current.paused||b||q.current.pause()},[b]),e.jsx("div",{className:"fixed w-full z-20 h-24 content-center bg-main-400 select-none border-t border-main-500/20 shadow-up",children:e.jsxs("div",{className:"flex justify-between px-4",children:[e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex",children:[e.jsx(u,{src:t?.thumbnail,effect:"blur",alt:"thumbnail",className:"w-16 h-16 object-cover"}),e.jsxs("div",{children:[e.jsx(l,{className:"font-semibold text-gray-800 line-clamp-2 text-ellipsis max-w-40",children:t?.title}),e.jsx(l,{className:"text-gray-700 line-clamp-2 text-ellipsis max-w-40 m-0 lg:text-xs",children:t?.artistNames})]}),e.jsx(x,{size:"icon",variant:"ghost","aria-label":"Like song",children:e.jsx(te,{size:20})}),e.jsx(x,{size:"icon",variant:"ghost","aria-label":"More options",children:e.jsx(ne,{size:20})})]}),e.jsxs("div",{className:"flex flex-1 items-center gap-4 flex-col",children:[e.jsxs("div",{className:"flex gap-8 items-center",children:[e.jsxs(h,{children:[e.jsx(m,{asChild:!0,children:e.jsx("button",{className:y?"text-purple-600":"",onClick:()=>k(e=>!e),"aria-label":"Toggle shuffle",children:e.jsx(le,{size:20})})}),e.jsx(j,{children:"Bật phát ngẫu nhiên"})]}),e.jsx(x,{size:"icon",variant:"ghost",onClick:O,disabled:!N.length,"aria-label":"Previous song",children:e.jsx(ie,{size:20})}),e.jsx("button",{onClick:V,className:"hover:text-main-500 p-0","aria-label":b?"Pause":"Play",children:E?e.jsx(Z,{strokeColor:"#0E8080",width:42,height:42}):b?e.jsx(ce,{size:42}):e.jsx(de,{size:42})}),e.jsxs(h,{children:[e.jsx(m,{asChild:!0,children:e.jsx("button",{onClick:B,disabled:!N.length,"aria-label":"Next song",children:e.jsx(oe,{size:20})})}),D&&e.jsxs(j,{children:[e.jsx(l,{className:"font-semibold",children:"Phát tiếp theo"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(u,{src:D.thumbnail,effect:"blur",alt:"thumbnail",className:"w-10 h-10 object-cover rounded-md"}),e.jsxs("div",{children:[e.jsx(l,{className:"m-0",children:D.title}),e.jsx(l,{className:"m-0 lg:text-xs",children:D.artistNames})]})]})]})]}),e.jsxs(h,{children:[e.jsx(m,{asChild:!0,children:e.jsx("button",{className:C?"text-purple-600":"",onClick:()=>T(2===C?0:C+1),"aria-label":"Toggle repeat mode",children:1===C?e.jsx(ue,{size:20}):e.jsx(xe,{size:20})})}),e.jsx(j,{children:"Phát lại tất cả bài hát"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-3 text-sm",children:[e.jsx(l,{ref:A,className:"font-semibold text-gray-700 m-0",children:"00:00"}),e.jsx("button",{className:"relative h-1 hover:h-2 bg-[#0000001a] w-3/5 rounded-full cursor-pointer",onClick:e=>{F(e.clientX)},onMouseDown:e=>{U.current=!0,F(e.clientX)},onMouseMove:e=>{U.current&&F(e.clientX)},onMouseUp:I,onMouseLeave:I,ref:P,"aria-label":"Seek audio",children:e.jsx("div",{ref:_,className:"absolute top-0 left-0 bottom-0 h-full bg-main-500 rounded-full"})}),e.jsx(l,{className:"font-semibold text-gray-700 m-0",children:f(t?.duration??0)})]})]}),e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex justify-end",children:[e.jsx(Be,{drawerTrigger:e.jsx(he,{size:20}),audioRef:q}),e.jsx(x,{size:"icon-lg",variant:"ghost",onClick:()=>z(0===L?50:0),"aria-label":0===L?"Unmute":"Mute",children:L>=50?e.jsx(me,{}):0===L?e.jsx(je,{}):e.jsx(fe,{})}),e.jsx("input",{type:"range",step:1,min:0,max:100,onChange:e=>z(Number(e.target.value)),value:L,className:"h-1 hover:h-2","aria-label":"Volume control"}),e.jsx(x,{className:"text-white",size:"lg",onClick:()=>a(p(!r)),"aria-label":"Toggle playlist sidebar",children:e.jsx(pe,{})})]})]})})},Ve=()=>{const{translate:a}=b(),r=ee(),[t,n]=s.useState("");return e.jsx("div",{className:"max-w-[440px] w-full",children:e.jsx("div",{className:"bg-[#ffffff34] text-white rounded-3xl py-2",children:e.jsxs("div",{className:"flex w-full",children:[e.jsx(ge,{className:"ml-4"}),e.jsx("input",{type:"text",className:"outline-none px-2 flex-1 bg-transparent",placeholder:a("search_placeholder"),name:"search",onKeyUp:e=>(e=>{"Enter"===e.code&&e.currentTarget.value.length>2&&r({pathname:"search/all",search:"?q="+e.currentTarget.value})})(e),onChange:e=>{n(e.target.value)},value:t}),e.jsx(we,{onClick:()=>n(""),className:(t?"block":"hidden")+" mr-4"})]})})})};function $e({className:a,...s}){return e.jsx(Le,{"data-slot":"avatar",className:t("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),...s})}function He({className:a,...s}){return e.jsx(ze,{"data-slot":"avatar-image",className:t("aspect-square size-full",a),...s})}function Ke({className:a,...s}){return e.jsx(Ee,{"data-slot":"avatar-fallback",className:t("bg-muted flex size-full items-center justify-center rounded-full",a),...s})}const Xe=()=>{const{user:a,signout:s}=N(),{translate:r}=b();return e.jsxs(y,{children:[e.jsx(k,{asChild:!0,children:e.jsx($e,{children:a?.avatar?e.jsx(He,{src:a?.avatar,alt:a?.id}):e.jsx(Ke,{children:a?.fullname.charAt(0)})})}),e.jsxs(C,{className:"w-56 z-100",align:"end",children:[e.jsx(T,{children:r("my_account")}),e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsx(ae,{to:E.UPLOAD_MUSIC,children:r("profile")}),e.jsx(S,{children:e.jsx(ve,{})})]}),e.jsxs(z,{children:[e.jsx(ae,{to:E.UPLOAD_MUSIC,children:r("settings")}),e.jsx(S,{children:e.jsx(be,{})})]}),e.jsxs(z,{children:[e.jsx(ae,{to:E.UPLOAD_MUSIC,children:r("upload_music")}),e.jsx(S,{children:e.jsx(Ne,{})})]}),e.jsxs(z,{children:[e.jsx(ae,{to:E.ADD_ARTIST,children:r("add_artist")}),e.jsx(S,{children:e.jsx(ye,{})})]})]}),e.jsx(M,{}),e.jsxs(z,{onClick:s,children:[r("logout"),e.jsx(S,{children:e.jsx(ke,{})})]})]})]})},Ge=()=>{const{onChangeLang:a,currentLang:s,allLangs:r}=b();return e.jsxs(y,{children:[e.jsx(k,{asChild:!0,children:e.jsx($e,{className:"rounded-sm",children:e.jsx(He,{src:s.icon,alt:s.value})})}),e.jsx(C,{className:"w-56 z-100",align:"end",children:e.jsx(L,{children:r.map(s=>e.jsxs(z,{onClick:()=>a(s.value),children:[e.jsx(l,{children:s.label}),e.jsx(S,{children:e.jsx("img",{src:s.icon,alt:s.value})})]},s.value))})})]})},Je=()=>{const{translate:a}=b();return e.jsxs(R,{children:[e.jsx(_,{asChild:!0,children:e.jsx(l,{variant:"span",className:"text-white",children:a("sign_in")})}),e.jsxs(P,{className:"sm:max-w-md",children:[e.jsx(q,{}),e.jsxs(A,{defaultValue:"sign_in",children:[e.jsxs(U,{children:[e.jsx(D,{value:"sign_in",children:a("sign_in")}),e.jsx(D,{value:"sign_up",children:a("sign_up")})]}),e.jsx(F,{value:"sign_in",children:e.jsx(Ye,{})}),e.jsx(F,{value:"sign_up",children:e.jsx(Ze,{})})]})]})]})},Qe=()=>{const a=ee(),{isAuthenticated:s}=N();return e.jsxs("div",{className:"w-full flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex my-2 gap-2 flex-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white cursor-pointer",children:[e.jsx(Ce,{onClick:()=>a(-1)}),e.jsx(Te,{onClick:()=>a(1)})]}),e.jsx(Ve,{})]}),e.jsx(Ge,{}),s?e.jsx(Xe,{}):e.jsx(Je,{})]})},We=()=>{const{showSideBarRight:a,scrollTop:s}=n(e=>e.app),{currentSong:r}=n(e=>e.music),t=se(),l=i();return e.jsxs("div",{className:"w-full bg-main-300 "+(r?"h-[calc(100vh-96px)]":"h-screen"),children:[e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx(I,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[e.jsx("header",{className:`fixed top-0 right-0 left-0 z-49 transition-all duration-500 ease-in-out sm:left-20 lg:left-48 flex-none backdrop-blur-md px-4 md:px-8 ${a&&"xl:right-[330px]"} ${s?"bg-transparent":"bg-[#969696cc]"}`,children:e.jsx(Qe,{})}),e.jsx("main",{className:`px-4 md:px-8 mt-14 pb-12 flex-auto overflow-y-scroll scroll-smooth transition-all duration-600 ease-in-out ${a&&"xl:mr-[330px] mr-0"}`,onScroll:e=>{(t.pathname.includes("/artist")||t.pathname.includes("/zing-chart"))&&0===e.currentTarget.scrollTop?l(O(!0)):l(O(!1))},children:e.jsx(re,{})})]}),e.jsx(B,{})]}),r&&e.jsx(Oe,{})]})},Ye=()=>{const{signin:a}=N(),{translate:r}=b(),t=Se().shape({email:Me().required("Email is required"),password:Me().required("Password is required")}),n=s.useMemo(()=>({email:"tien23851@gmail.com",password:"123456"}),[]),l=Re({resolver:V(t),defaultValues:n}),{handleSubmit:i}=l;return e.jsxs($,{methods:l,onSubmit:i(async e=>{await a(e.email,e.password)}),children:[e.jsxs(H,{children:[e.jsx(q,{}),e.jsx(K,{children:r("sign_in_description")})]}),e.jsxs(X,{className:"gap-4 my-6",children:[e.jsx(G,{name:"email",type:"text",fieldLabel:"Email",placeholder:"Type your email"}),e.jsx(G,{name:"password",type:"password",fieldLabel:"Password",placeholder:"Type your password"})]}),e.jsx(J,{children:e.jsx(Q,{orientation:"vertical",children:e.jsxs(Q,{orientation:"horizontal",children:[e.jsx(W,{asChild:!0,children:e.jsx(x,{type:"reset",variant:"outline",className:"flex-auto",children:"Reset"})}),e.jsx(x,{type:"submit",className:"flex-auto",children:"Submit"})]})})})]})},Ze=()=>{const{signup:a}=N(),{translate:r}=b(),t=Se().shape({fullname:Me().required("Full name is required"),email:Me().required("Email is required"),password:Me().required("Password is required"),confirmPassword:Me().required("Confirm password is required")}),n=s.useMemo(()=>({fullname:"",email:"",password:"",confirmPassword:""}),[]),l=Re({resolver:V(t),defaultValues:n}),{handleSubmit:i}=l;return e.jsxs($,{methods:l,onSubmit:i(async e=>{await a(e.fullname,e.email,e.password)}),children:[e.jsxs(H,{children:[e.jsx(q,{}),e.jsx(K,{children:r("sign_up_description")})]}),e.jsxs(X,{className:"gap-4 my-6",children:[e.jsx(G,{name:"fullname",type:"text",fieldLabel:"Fullname",placeholder:"Type your full name"}),e.jsx(G,{name:"email",type:"text",fieldLabel:"Email",placeholder:"Type your email"}),e.jsx(G,{name:"password",type:"password",fieldLabel:"Password",placeholder:"Type your password"}),e.jsx(G,{name:"confirmPassword",type:"password",fieldLabel:"Confirm password",placeholder:"Confirm your password"})]}),e.jsx(J,{children:e.jsx(Q,{orientation:"vertical",children:e.jsxs(Q,{orientation:"horizontal",children:[e.jsx(W,{asChild:!0,children:e.jsx(x,{type:"reset",variant:"outline",className:"flex-auto",children:"Reset"})}),e.jsx(x,{type:"submit",className:"flex-auto",children:"Submit"})]})})})]})};export{We as default};
