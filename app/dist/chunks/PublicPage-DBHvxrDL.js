import{j as e,R as s,a}from"./react-query-chunk-C3JHXiwa.js";import{D as r,c as t,u as n,T as l,a as i,s as c,b as d,d as o,L as u,e as x,f as m,g as h,h as j,B as f,i as p,j as g,k as w,l as v,m as b,n as N,o as y,p as C,q as k,r as T,t as L,v as E,w as z,x as S,y as R,z as M,A as _,C as q,E as A,F as P,G as D,H as U,I as F,S as I,J as $,K as B,M as O,N as H,O as K,P as V,Q as X,R as G,U as J,V as Q,W}from"../entries/index-6LPxpzWC.js";import{k as Y,d as Z,u as ee,L as se,l as ae,O as re}from"./react-chunk-vjlR_Xb7.js";import{H as te,E as ne,v as le,w as ie,x as ce,m as de,y as oe,R as ue,z as xe,B as me,V as he,F as je,G as fe,M as pe,e as ge,X as we,U as ve,J as be,K as Ne,Q as ye,Y as Ce,Z as ke,$ as Te}from"./mix-chunk-Csz3FfyW.js";import{K as Le,M as Ee,N as ze}from"./radix-ui-chunk-BJyeau2d.js";import{c as Se,b as Re,e as Me}from"./form-chunk-DWXro7yB.js";import"./i18next-chunk-DrW9RIaf.js";import"./redux-chunk-DOlE0zqP.js";function _e({...s}){return e.jsx(r.Root,{"data-slot":"drawer",...s})}function qe({...s}){return e.jsx(r.Trigger,{"data-slot":"drawer-trigger",...s})}function Ae({...s}){return e.jsx(r.Portal,{"data-slot":"drawer-portal",...s})}function Pe({className:s,...a}){return e.jsx(r.Overlay,{"data-slot":"drawer-overlay",className:t("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...a})}function De({className:s,children:a,...n}){return e.jsxs(Ae,{"data-slot":"drawer-portal",children:[e.jsx(Pe,{}),e.jsxs(r.Content,{"data-slot":"drawer-content",className:t("group/drawer-content bg-background fixed z-50 flex h-auto flex-col ","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",s),...n,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),a]})]})}function Ue({className:s,...a}){return e.jsx("div",{"data-slot":"drawer-header",className:t("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",s),...a})}function Fe({className:s,...a}){return e.jsx(r.Title,{"data-slot":"drawer-title",className:t("text-foreground font-semibold",s),...a})}function Ie({className:s,...a}){return e.jsx(r.Description,{"data-slot":"drawer-description",className:t("text-muted-foreground text-sm",s),...a})}const $e=({drawerTrigger:a,audioRef:r})=>{const{currentSong:t}=n(e=>e.music),[i,c]=s.useState(""),[d,o]=s.useState(0),u=s.useRef(null),x=s.useRef(null);return s.useEffect(()=>{if((async()=>{if(t?.lyricsFile){const e=await fetch(t.lyricsFile),s=await e.text();c(s.replaceAll("\r\n","\n"))}})(),r.current){const e=setInterval(()=>{r.current&&o(1e3*r.current.currentTime)},1500);return()=>clearInterval(e)}},[r.current]),s.useEffect(()=>{if(u.current&&x.current){const e=u.current.clientHeight,s=u.current.offsetTop-10*e;x.current.scrollTo({top:s,behavior:"smooth"})}},[d]),e.jsxs(_e,{children:[e.jsx(qe,{asChild:!0,children:a}),e.jsx(De,{className:"bg-white/70 min-h-[calc(100vh-96px)] backdrop-blur-md",children:e.jsxs("div",{className:"mx-auto w-full h-screen max-w-6xl relative",children:[e.jsxs(Ue,{children:[e.jsx(Fe,{children:"Lời bài hát"}),e.jsxs(Ie,{children:[t?.title," - ",t?.artistNames]})]}),e.jsx("div",{ref:x,className:"h-[65vh] overflow-auto px-4",children:i.length>0?e.jsx(Y,{lrc:i,currentMillisecond:d,lineRenderer:({index:s,active:a,line:r})=>e.jsx(l,{ref:a?u:null,variant:"h4",className:"my-8 text-center transition-colors duration-300 "+(a?"text-main-500":"text-gray-400"),children:r.content},s)}):e.jsx(l,{className:"text-center text-gray-400",children:"Không có lời bài hát"})})]})})]})},Be=()=>{const s=i(),{showSideBarRight:r}=n(e=>e.app),{currentSong:t,isPlaying:b,currentPlaylistSongs:N}=n(e=>e.music),[y,C]=a.useState(!1),[k,T]=a.useState(0),[L,E]=a.useState(50),[z,S]=a.useState(!0),R=a.useRef(!1),M=a.useRef(0),_=a.useRef(null),q=a.useRef(null),A=a.useRef(null),P=a.useRef(null),D=a.useRef(!1),U=a.useMemo(()=>{if(!t)return;const e=N.findIndex(e=>e.id===t.id);return-1===e?void 0:N[e+1]},[t,N]),F=e=>{if(!q.current||!A.current||!_.current)return;const s=q.current.getBoundingClientRect(),a=(e-s.left)/s.width*100,r=Math.max(0,Math.min(100,Math.round(a)));_.current.style.cssText=`right: ${100-r}%`,t?.duration&&(A.current.currentTime=t.duration*r/100)},I=()=>{D.current=!1},$=a.useCallback(()=>{if(N.length>0)for(let e=0;e<N.length;e++)if(N[e].id===t?.id){N[e+1]&&(s(c(N[e+1])),A.current?.play());break}},[N,t,s]),B=a.useCallback(()=>{if(N.length>0)for(let e=0;e<N.length;e++)if(N[e].id===t?.id){N[e-1]&&(s(c(N[e-1])),A.current?.play());break}},[N,t,s]),O=a.useCallback(async()=>{A.current&&(b&&!A.current.paused?(s(d(!1)),A.current.pause()):!b&&A.current.paused&&(s(d(!0)),await A.current.play()))},[b,s]),H=()=>{S(!1),A.current?.play().then(e=>s(d(!0))).catch(e=>{})};return a.useEffect(()=>((async()=>{if(s(d(!1)),P.current&&(P.current.innerText="00:00"),_.current&&(_.current.style.cssText="right: 100%"),t?.stream){S(!0),await g(t.id)||await w(t.id,t.stream);let e=await v(t.id);e&&(A.current=new Audio(e),A.current.load(),A.current.volume=L/100,A.current.oncanplaythrough=H,(()=>{let e;const a=A.current;if(!a?.src)return;const r=()=>{P.current.innerText=j(Math.floor(a.currentTime));let s=Math.round(a.currentTime/t.duration*1e4)/100;_.current&&(_.current.style.cssText=`right: ${100-s}%`),e=requestAnimationFrame(r)},n=()=>e=requestAnimationFrame(r),l=()=>cancelAnimationFrame(e),i=()=>{l(),R.current?A.current&&A.current.play():M.current>0?1===M.current?A.current&&(A.current.currentTime=0,A.current.play()):$():(s(d(!1)),a.pause())};a.addEventListener("play",n),a.addEventListener("pause",l),a.addEventListener("ended",i)})())}})(),()=>{A.current&&(A.current.oncanplaythrough=null,A.current.pause(),A.current=null)}),[t]),a.useEffect(()=>{const e=e=>{if("Space"===e.code&&e.target instanceof HTMLElement){const s=e.target.tagName.toLowerCase();if("input"===s||"textarea"===s||e.target.isContentEditable)return;e.preventDefault(),O()}},s=e=>{if(("ArrowLeft"===e.code||"ArrowRight"===e.code)&&e.target instanceof HTMLElement){const s=e.target.tagName.toLowerCase();if("input"===s||"textarea"===s||e.target.isContentEditable)return;e.preventDefault(),"ArrowLeft"===e.code&&B(),"ArrowRight"===e.code&&$()}};return globalThis.addEventListener("keydown",e),globalThis.addEventListener("keydown",s),()=>{globalThis.removeEventListener("keydown",e),globalThis.removeEventListener("keydown",s)}},[b,O,B,$]),a.useEffect(()=>{A.current&&(A.current.volume=L/100)},[L]),a.useEffect(()=>{s(o()),R.current=y},[y]),a.useEffect(()=>{M.current=k},[k]),a.useEffect(()=>{A.current&&A.current.paused&&b&&A.current.play(),!A.current||A.current.paused||b||A.current.pause()},[b]),e.jsx("div",{className:"fixed w-full z-20 h-24 content-center bg-main-400 select-none border-t border-main-500/20 shadow-up",children:e.jsxs("div",{className:"flex justify-between px-4",children:[e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex",children:[e.jsx(u,{src:t?.thumbnail,effect:"blur",alt:"thumbnail",className:"w-16 h-16 object-cover"}),e.jsxs("div",{children:[e.jsx(l,{className:"font-semibold text-gray-600 line-clamp-2 text-ellipsis max-w-40",children:t?.title}),e.jsx(l,{className:"text-gray-500 line-clamp-2 text-ellipsis max-w-40 m-0 lg:text-xs",children:t?.artistNames})]}),e.jsx(te,{size:20}),e.jsx(ne,{size:20})]}),e.jsxs("div",{className:"flex flex-1 items-center gap-4 flex-col",children:[e.jsxs("div",{className:"flex gap-8 items-center",children:[e.jsxs(x,{children:[e.jsx(m,{asChild:!0,className:`cursor-pointer ${y&&"text-purple-600"}`,onClick:()=>C(e=>!e),children:e.jsx(le,{size:20})}),e.jsx(h,{children:"Bật phát ngẫu nhiên"})]}),e.jsx("span",{className:N.length?"cursor-pointer":"text-gray-500",children:e.jsx(ie,{size:20,onClick:B})}),e.jsx("button",{onClick:O,className:"hover:text-main-500",children:z?e.jsx(Z,{strokeColor:"#0E8080",width:42,height:42}):b?e.jsx(ce,{size:42}):e.jsx(de,{size:42})}),e.jsxs(x,{children:[e.jsx(m,{asChild:!0,children:e.jsx(oe,{size:20,onClick:$,className:N.length?"cursor-pointer":"text-gray-500"})}),U&&e.jsxs(h,{children:[e.jsx(l,{className:"font-semibold",children:"Phát tiếp theo"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(u,{src:U.thumbnail,effect:"blur",alt:"thumbnail",className:"w-10 h-10 object-cover rounded-md"}),e.jsxs("div",{className:"text-gray-400",children:[e.jsx(l,{className:"m-0",children:U.title}),e.jsx(l,{className:"m-0 lg:text-xs",children:U.artistNames})]})]})]})]}),e.jsxs(x,{children:[e.jsx(m,{asChild:!0,className:`cursor-pointer ${k&&"text-purple-600"}`,onClick:()=>T(2===k?0:k+1),children:1===k?e.jsx(ue,{size:20}):e.jsx(xe,{size:20})}),e.jsx(h,{children:"Phát lại tất cả bài hát"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-3 text-sm",children:[e.jsx(l,{ref:P,className:"font-semibold text-gray-500 m-0",children:"00:00"}),e.jsx("button",{className:"relative h-1 hover:h-2 bg-[#0000001a] w-3/5 rounded-full cursor-pointer",onClick:e=>{F(e.clientX)},onMouseDown:e=>{D.current=!0,F(e.clientX)},onMouseMove:e=>{D.current&&F(e.clientX)},onMouseUp:I,onMouseLeave:I,ref:q,children:e.jsx("div",{ref:_,className:"absolute top-0 left-0 bottom-0 h-full bg-main-500 rounded-full"})}),e.jsx(l,{className:"font-semibold text-gray-500 m-0",children:j(t?.duration??0)})]})]}),e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex justify-end",children:[e.jsx($e,{drawerTrigger:e.jsx(me,{size:20}),audioRef:A}),e.jsx(f,{size:"icon-lg",variant:"ghost",onClick:()=>E(0===L?50:0),children:L>=50?e.jsx(he,{}):0===L?e.jsx(je,{}):e.jsx(fe,{})}),e.jsx("input",{type:"range",step:1,min:0,max:100,onChange:e=>E(Number(e.target.value)),value:L,className:"h-1 hover:h-2"}),e.jsx(f,{className:"text-white",size:"lg",onClick:()=>s(p(!r)),children:e.jsx(pe,{})})]})]})})},Oe=()=>{const{translate:s}=b(),r=ee(),[t,n]=a.useState("");return e.jsx("div",{className:"max-w-[440px] w-full",children:e.jsx("div",{className:"bg-[#ffffff54] text-gray-500 rounded-3xl py-2",children:e.jsxs("div",{className:"flex w-full",children:[e.jsx("div",{className:"pl-4 self-center",children:e.jsx(ge,{})}),e.jsx("input",{type:"text",className:"outline-none px-4 w-full bg-transparent",placeholder:s("search_placeholder"),onKeyUp:e=>(e=>{"Enter"===e.code&&e.currentTarget.value.length>2&&r({pathname:"search/all",search:"?q="+e.currentTarget.value})})(e),onChange:e=>{n(e.target.value)},value:t}),e.jsx("div",{className:(t?"block":"hidden")+" self-center pr-4",onClick:()=>n(""),children:e.jsx(we,{})})]})})})};function He({className:s,...a}){return e.jsx(Le,{"data-slot":"avatar",className:t("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...a})}function Ke({className:s,...a}){return e.jsx(Ee,{"data-slot":"avatar-image",className:t("aspect-square size-full",s),...a})}function Ve({className:s,...a}){return e.jsx(ze,{"data-slot":"avatar-fallback",className:t("bg-muted flex size-full items-center justify-center rounded-full",s),...a})}const Xe=()=>{const{user:s,signout:a}=N(),{translate:r}=b();return e.jsxs(y,{children:[e.jsx(C,{asChild:!0,children:e.jsx(He,{children:s?.avatar?e.jsx(Ke,{src:s?.avatar,alt:s?.id}):e.jsx(Ve,{children:s?.fullname.charAt(0)})})}),e.jsxs(k,{className:"w-56 z-100",align:"end",children:[e.jsx(T,{children:r("my_account")}),e.jsxs(L,{children:[e.jsxs(E,{children:[e.jsx(se,{to:z.UPLOAD_MUSIC,children:r("profile")}),e.jsx(S,{children:e.jsx(ve,{})})]}),e.jsxs(E,{children:[e.jsx(se,{to:z.UPLOAD_MUSIC,children:r("settings")}),e.jsx(S,{children:e.jsx(be,{})})]}),e.jsxs(E,{children:[e.jsx(se,{to:z.UPLOAD_MUSIC,children:r("upload_music")}),e.jsx(S,{children:e.jsx(Ne,{})})]}),e.jsxs(E,{children:[e.jsx(se,{to:z.ADD_ARTIST,children:r("add_artist")}),e.jsx(S,{children:e.jsx(ye,{})})]})]}),e.jsx(R,{}),e.jsxs(E,{onClick:a,children:[r("logout"),e.jsx(S,{children:e.jsx(Ce,{})})]})]})]})},Ge=()=>{const{onChangeLang:s,currentLang:a,allLangs:r}=b();return e.jsxs(y,{children:[e.jsx(C,{asChild:!0,children:e.jsx(He,{className:"rounded-sm",children:e.jsx(Ke,{src:a.icon,alt:a.value})})}),e.jsx(k,{className:"w-56 z-100",align:"end",children:e.jsx(L,{children:r.map(a=>e.jsxs(E,{onClick:()=>s(a.value),children:[e.jsx(l,{children:a.label}),e.jsx(S,{children:e.jsx("img",{src:a.icon,alt:a.value})})]},a.value))})})]})},Je=()=>{const{translate:s}=b();return e.jsxs(M,{children:[e.jsx(_,{asChild:!0,children:e.jsx(l,{variant:"span",className:"text-white",children:s("sign_in")})}),e.jsxs(q,{className:"sm:max-w-md",children:[e.jsx(A,{}),e.jsxs(P,{defaultValue:"sign_in",children:[e.jsxs(D,{children:[e.jsx(U,{value:"sign_in",children:s("sign_in")}),e.jsx(U,{value:"sign_up",children:s("sign_up")})]}),e.jsx(F,{value:"sign_in",children:e.jsx(Ye,{})}),e.jsx(F,{value:"sign_up",children:e.jsx(Ze,{})})]})]})]})},Qe=()=>{const s=ee(),{isAuthenticated:a}=N();return e.jsxs("div",{className:"w-full flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex my-2 gap-2 flex-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white cursor-pointer",children:[e.jsx(ke,{onClick:()=>s(-1)}),e.jsx(Te,{onClick:()=>s(1)})]}),e.jsx(Oe,{})]}),e.jsx(Ge,{}),a?e.jsx(Xe,{}):e.jsx(Je,{})]})},We=()=>{const{showSideBarRight:s,scrollTop:a}=n(e=>e.app),{currentSong:r}=n(e=>e.music),t=ae(),l=i();return e.jsxs("div",{className:"w-full bg-main-300 "+(r?"h-[calc(100vh-96px)]":"h-screen"),children:[e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx(I,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[e.jsx("header",{className:`fixed top-0 right-0 left-0 z-49 transition-all duration-500 ease-in-out sm:left-20 lg:left-48 flex-none backdrop-blur-md px-4 md:px-8 ${s&&"xl:right-[330px]"} ${a?"bg-transparent":"bg-[#969696cc]"}`,children:e.jsx(Qe,{})}),e.jsx("main",{className:`px-4 md:px-8 mt-14 pb-12 flex-auto overflow-y-scroll scroll-smooth transition-all duration-600 ease-in-out ${s&&"xl:mr-[330px] mr-0"}`,onScroll:e=>{(t.pathname.includes("/artist")||t.pathname.includes("/zing-chart"))&&0===e.currentTarget.scrollTop?l(B(!0)):l(B(!1))},children:e.jsx(re,{})})]}),e.jsx($,{})]}),r&&e.jsx(Be,{})]})},Ye=()=>{const{signin:s}=N(),{translate:r}=b(),t=Se().shape({email:Re().required("Email is required"),password:Re().required("Password is required")}),n=a.useMemo(()=>({email:"tien23851@gmail.com",password:"123456"}),[]),l=Me({resolver:O(t),defaultValues:n}),{handleSubmit:i}=l;return e.jsxs(H,{methods:l,onSubmit:i(async e=>{await s(e.email,e.password)}),children:[e.jsxs(K,{children:[e.jsx(A,{}),e.jsx(V,{children:r("sign_in_description")})]}),e.jsxs(X,{className:"gap-4 my-6",children:[e.jsx(G,{name:"email",type:"text",fieldLabel:"Email",placeholder:"Type your email"}),e.jsx(G,{name:"password",type:"password",fieldLabel:"Password",placeholder:"Type your password"})]}),e.jsx(J,{children:e.jsx(Q,{orientation:"vertical",children:e.jsxs(Q,{orientation:"horizontal",children:[e.jsx(W,{asChild:!0,children:e.jsx(f,{type:"reset",variant:"outline",className:"flex-auto",children:"Reset"})}),e.jsx(f,{type:"submit",className:"flex-auto",children:"Submit"})]})})})]})},Ze=()=>{const{signup:s}=N(),{translate:r}=b(),t=Se().shape({fullname:Re().required("Full name is required"),email:Re().required("Email is required"),password:Re().required("Password is required"),confirmPassword:Re().required("Confirm password is required")}),n=a.useMemo(()=>({fullname:"",email:"",password:"",confirmPassword:""}),[]),l=Me({resolver:O(t),defaultValues:n}),{handleSubmit:i}=l;return e.jsxs(H,{methods:l,onSubmit:i(async e=>{await s(e.fullname,e.email,e.password)}),children:[e.jsxs(K,{children:[e.jsx(A,{}),e.jsx(V,{children:r("sign_up_description")})]}),e.jsxs(X,{className:"gap-4 my-6",children:[e.jsx(G,{name:"fullname",type:"text",fieldLabel:"Fullname",placeholder:"Type your full name"}),e.jsx(G,{name:"email",type:"text",fieldLabel:"Email",placeholder:"Type your email"}),e.jsx(G,{name:"password",type:"password",fieldLabel:"Password",placeholder:"Type your password"}),e.jsx(G,{name:"confirmPassword",type:"password",fieldLabel:"Confirm password",placeholder:"Confirm your password"})]}),e.jsx(J,{children:e.jsx(Q,{orientation:"vertical",children:e.jsxs(Q,{orientation:"horizontal",children:[e.jsx(W,{asChild:!0,children:e.jsx(f,{type:"reset",variant:"outline",className:"flex-auto",children:"Reset"})}),e.jsx(f,{type:"submit",className:"flex-auto",children:"Submit"})]})})})]})};export{We as default};
