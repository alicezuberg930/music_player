import{j as e,n as Ke,J as Xe,p as Ge,V as fe,K as Ye,M as Ze,o as Je,O as Qe,d as pe,u as et,a as tt,P as xe,e as at,W as rt,q as st,X as nt,Y as Q}from"./radix-ui-vendor-C-JCx0tB.js";import{c as y,a as j,X as me,u as ot,C as it,L as ct,b as lt,d as dt,e as oe,f as ut,g as ht,F as ft,R as ie,B,h as ge,o as pt,i as xt,j as ee,k as O,T as N,s as mt,l as gt,D as M,m as z,n as vt,p as ve,q as ce,r as R,t as le,v as de,H as jt,E as yt,w as X,x as G,y as Y,z as wt,A as ue,M as bt,G as kt,S as Nt,I as St,J as je,K as ye,N as we,O as Ct,P as be,Q as A,U as T,V as $,W as _t,Y as Mt,Z as Lt,_ as Z}from"./index-CqJa-0UH.js";import{r as i,N as Et,c as P,u as ke,R as Pt,L as D,h as At,O as Rt}from"./react-vendor-BD1XKfxA.js";import"./redux-vendor-DEMHk9Hm.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],$t=y("arrow-left",Tt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],zt=y("arrow-right",Dt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],Ht=y("circle-pause",It);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]],Ft=y("mic-vocal",Bt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qt=y("plus",Ot);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]],Vt=y("repeat-1",Ut);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Kt=y("repeat",Wt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Gt=y("settings",Xt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],Zt=y("shuffle",Yt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],Qt=y("skip-back",Jt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],ta=y("skip-forward",ea);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"M15.295 19.562 16 22",key:"31jsb7"}],["path",{d:"m17 16 3.758 2.098",key:"121ar7"}],["path",{d:"m19 12.5 3.026-.598",key:"19ukd3"}],["path",{d:"M7.61 6.3a3 3 0 0 0-3.92 1.3l-1.38 2.79a3 3 0 0 0 1.3 3.91l6.89 3.597a1 1 0 0 0 1.342-.447l3.106-6.211a1 1 0 0 0-.447-1.341z",key:"lwb9l9"}],["path",{d:"M8 9V2",key:"1xa0v7"}]],ra=y("spotlight",aa);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],na=y("upload",sa);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]],ia=y("volume-1",oa);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],la=y("volume-2",ca);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],ua=y("volume-x",da);function ha({...t}){return e.jsx(Ke,{"data-slot":"dialog",...t})}function fa({...t}){return e.jsx(Xe,{"data-slot":"dialog-trigger",...t})}function pa({...t}){return e.jsx(Je,{"data-slot":"dialog-portal",...t})}function xa({...t}){return e.jsx(fe,{"data-slot":"dialog-close",...t})}function ma({className:t,...a}){return e.jsx(Qe,{"data-slot":"dialog-overlay",className:j("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function ga({className:t,children:a,showCloseButton:r=!0,...s}){return e.jsxs(pa,{"data-slot":"dialog-portal",children:[e.jsx(ma,{}),e.jsxs(Ge,{"data-slot":"dialog-content",className:j("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s,children:[a,r&&e.jsxs(fe,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(me,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function va({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:j("flex flex-col gap-2 text-center sm:text-left",t),...a})}function ja({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-footer",className:j("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function ya({className:t,...a}){return e.jsx(Ye,{"data-slot":"dialog-title",className:j("text-lg leading-none font-semibold",t),...a})}function wa({className:t,...a}){return e.jsx(Ze,{"data-slot":"dialog-description",className:j("text-muted-foreground text-sm",t),...a})}function ba(t){const a=i.useRef({value:t,previous:t});return i.useMemo(()=>(a.current.value!==t&&(a.current.previous=a.current.value,a.current.value=t),a.current.previous),[t])}var q="Switch",[ka]=tt(q),[Na,Sa]=ka(q),Ne=i.forwardRef((t,a)=>{const{__scopeSwitch:r,name:s,checked:n,defaultChecked:o,required:l,disabled:c,value:f="on",onCheckedChange:u,form:p,...x}=t,[v,w]=i.useState(null),b=pe(a,_=>w(_)),k=i.useRef(!1),C=v?p||!!v.closest("form"):!0,[h,L]=et({prop:n,defaultProp:o??!1,onChange:u,caller:q});return e.jsxs(Na,{scope:r,checked:h,disabled:c,children:[e.jsx(xe.button,{type:"button",role:"switch","aria-checked":h,"aria-required":l,"data-state":Me(h),"data-disabled":c?"":void 0,disabled:c,value:f,...x,ref:b,onClick:at(t.onClick,_=>{L(E=>!E),C&&(k.current=_.isPropagationStopped(),k.current||_.stopPropagation())})}),C&&e.jsx(_e,{control:v,bubbles:!k.current,name:s,value:f,checked:h,required:l,disabled:c,form:p,style:{transform:"translateX(-100%)"}})]})});Ne.displayName=q;var Se="SwitchThumb",Ce=i.forwardRef((t,a)=>{const{__scopeSwitch:r,...s}=t,n=Sa(Se,r);return e.jsx(xe.span,{"data-state":Me(n.checked),"data-disabled":n.disabled?"":void 0,...s,ref:a})});Ce.displayName=Se;var Ca="SwitchBubbleInput",_e=i.forwardRef(({__scopeSwitch:t,control:a,checked:r,bubbles:s=!0,...n},o)=>{const l=i.useRef(null),c=pe(l,o),f=ba(r),u=rt(a);return i.useEffect(()=>{const p=l.current;if(!p)return;const x=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(x,"checked").set;if(f!==r&&w){const b=new Event("click",{bubbles:s});w.call(p,r),p.dispatchEvent(b)}},[f,r,s]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:c,style:{...n.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});_e.displayName=Ca;function Me(t){return t?"checked":"unchecked"}var _a=Ne,Ma=Ce;function La({className:t,...a}){return e.jsx(_a,{"data-slot":"switch",className:j("peer data-[state=checked]:bg-main-500 data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(Ma,{"data-slot":"switch-thumb",className:j("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Ea({name:t,label:a,helperText:r,disabled:s,className:n}){const{control:o}=ot();return e.jsx(it,{name:t,control:o,render:({field:l,fieldState:{error:c}})=>e.jsxs("div",{className:n,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(La,{id:t,checked:l.value,onCheckedChange:l.onChange,disabled:s}),a&&e.jsx(ct,{htmlFor:t,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:a})]}),(r||c)&&e.jsx("p",{className:`mt-1 text-sm ${c?"text-destructive":"text-muted-foreground"}`,children:c?c.message:r})]})})}const Pa=({triggerElement:t})=>{const{enqueueSnackbar:a}=lt(),[r,s]=i.useState(!1),n=dt().shape({isPrivate:ut().required("Privacy setting is required"),title:oe().required("Title is required"),description:oe().optional()}),o={isPrivate:!0},l=ht({resolver:pt(n),defaultValues:o}),{handleSubmit:c,reset:f,formState:{isSubmitting:u}}=l,p=async x=>{try{const v=new FormData;Object.entries(x).forEach(([b,k])=>v.append(b,k));const w=await xt(v);w?.statusCode&&w?.statusCode===201?(s(!1),f(),a(w.message,{variant:"success"})):a("Có lỗi xảy ra khi tạo danh sách phát",{variant:"error"})}catch(v){console.error(v)}};return e.jsxs(ha,{open:r,onOpenChange:s,children:[e.jsx(fa,{asChild:!0,children:t}),e.jsx(ga,{className:"sm:max-w-md",children:e.jsxs(ft,{methods:l,onSubmit:c(p),children:[e.jsxs(va,{children:[e.jsx(ya,{children:"Tạo danh sách phát"}),e.jsx(wa,{children:"Nhập thông tin danh sách phát của bạn bên dưới."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ie,{name:"title",fieldLabel:"Tiêu đề",placeholder:"Nhập tiêu đề"}),e.jsx(ie,{name:"description",fieldLabel:"Mô tả",placeholder:"Nhập mô tả"}),e.jsx(Ea,{name:"isPrivate",label:"Riêng tư",helperText:"Đặt chế độ riêng tư"})]}),e.jsxs(ja,{children:[e.jsx(xa,{asChild:!0,children:e.jsx(B,{variant:"outline",children:"Hủy"})}),e.jsx(B,{type:"submit",disabled:u,children:u?e.jsx(ge,{strokeColor:"white"}):"Tạo"})]})]})})]})},Aa=()=>{const{isAuthenticated:t}=ee(),{translate:a}=O();return e.jsx("div",{className:"sm:block hidden lg:w-48 w-20 flex-none border bg-main-200 transition-all duration-1500 ease-in-out",children:e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"w-full h-16 py-4 px-6 flex justify-start items-center gap-1",children:[e.jsx("img",{src:"/vite.svg",alt:"logo"}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(N,{className:"m-0 font-semibold",children:"Tiến's MP3"})})]}),e.jsx("div",{className:"flex flex-col",children:mt.map(r=>e.jsxs(Et,{to:r.path,className:({isActive:s})=>j("text-gray-500 text-sm py-2 px-6 font-bold flex gap-3 items-center justify-start",s&&"text-[#0F7070] bg-main-100"),children:[r.icon,e.jsx(N,{className:"hidden lg:inline m-0",children:a(r.text)})]},r.path))}),t&&e.jsx(Pa,{triggerElement:e.jsxs("div",{className:"text-gray-500 text-sm py-2 px-6 font-bold flex gap-3 items-center justify-start absolute bottom-0 border-t border-gray-400 w-full",children:[e.jsx(qt,{}),e.jsx(N,{className:"hidden lg:inline m-0",children:a("create_playlist")})]})})]})})},Ra="music-player-audio",I="audio-files",Ta=1;let J=null;const te=async()=>(J||(J=gt(Ra,Ta,{upgrade(t){t.objectStoreNames.contains(I)||t.createObjectStore(I)}})),J),$a=async(t,a)=>{try{const r=await fetch(a);if(!r.ok)throw new Error(`Failed to fetch audio: ${r.statusText}`);const s=await r.blob();return await(await te()).put(I,{songId:t,blob:s,url:a,cachedAt:Date.now()},t),console.log(`Audio cached successfully for song: ${t}`),!0}catch(r){return console.error(`Error caching audio for song ${t}:`,r),!1}},Da=async t=>{try{return!!await(await te()).get(I,t)}catch(a){return console.error(`Error checking cache for song ${t}:`,a),!1}},za=async t=>{try{const r=await(await te()).get(I,t);if(r){const s=URL.createObjectURL(r.blob);return console.log(`Audio retrieved from cache for song: ${t}`),s}return null}catch(a){return console.error(`Error retrieving audio from cache for song ${t}:`,a),null}};function Ia({...t}){return e.jsx(M.Root,{"data-slot":"drawer",...t})}function Ha({...t}){return e.jsx(M.Trigger,{"data-slot":"drawer-trigger",...t})}function Ba({...t}){return e.jsx(M.Portal,{"data-slot":"drawer-portal",...t})}function Fa({className:t,...a}){return e.jsx(M.Overlay,{"data-slot":"drawer-overlay",className:j("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function Oa({className:t,children:a,...r}){return e.jsxs(Ba,{"data-slot":"drawer-portal",children:[e.jsx(Fa,{}),e.jsxs(M.Content,{"data-slot":"drawer-content",className:j("group/drawer-content bg-background fixed z-50 flex h-auto flex-col ","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...r,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),a]})]})}function qa({className:t,...a}){return e.jsx("div",{"data-slot":"drawer-header",className:j("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...a})}function Ua({className:t,...a}){return e.jsx(M.Title,{"data-slot":"drawer-title",className:j("text-foreground font-semibold",t),...a})}function Va({className:t,...a}){return e.jsx(M.Description,{"data-slot":"drawer-description",className:j("text-muted-foreground text-sm",t),...a})}const Wa=({drawerTrigger:t,audioRef:a})=>{const{currentSong:r}=z(u=>u.music),[s,n]=P.useState(""),[o,l]=P.useState(0),c=P.useRef(null),f=P.useRef(null);return P.useEffect(()=>{if((async()=>{if(r?.lyricsFile){const x=await(await fetch(r.lyricsFile)).text();n(x.replace(/\r\n/g,`
`))}})(),a.current){const p=setInterval(()=>{a.current&&l(a.current.currentTime*1e3)},1500);return()=>clearInterval(p)}},[a.current]),P.useEffect(()=>{if(c.current&&f.current){const u=c.current.clientHeight,p=c.current.offsetTop,x=c.current.clientHeight,v=p-u/2-x/2;f.current.scrollTo({top:v,behavior:"smooth"})}},[o]),e.jsxs(Ia,{children:[e.jsx(Ha,{asChild:!0,children:t}),e.jsx(Oa,{className:"bg-white/70 min-h-[calc(100vh-96px)] backdrop-blur-md",children:e.jsxs("div",{className:"mx-auto w-full h-screen max-w-6xl relative",children:[e.jsxs(qa,{children:[e.jsx(Ua,{children:"Lời bài hát"}),e.jsxs(Va,{children:[r?.title," - ",r?.artistNames]})]}),e.jsx("div",{ref:f,className:"h-[65vh] overflow-auto px-4",children:s.length>0?e.jsx(vt,{lrc:s,currentMillisecond:o,lineRenderer:({index:u,active:p,line:x})=>e.jsx(N,{ref:p?c:null,variant:"h4",className:`my-8 text-center transition-colors duration-300 ${p?"text-main-500":"text-gray-400"}`,children:x.content},u)}):e.jsx(N,{className:"text-center text-gray-400",children:"Không có lời bài hát"})})]})})]})},Ka=()=>{const t=ve(),{showSideBarRight:a}=z(d=>d.app),{currentSong:r,isPlaying:s,currentPlaylistSongs:n}=z(d=>d.music),[o,l]=i.useState(!1),[c,f]=i.useState(0),[u,p]=i.useState(50),[x,v]=i.useState(!0),w=i.useRef(!1),b=i.useRef(0),k=i.useRef(null),C=i.useRef(null),h=i.useRef(null),L=i.useRef(null),_=i.useRef(!1),E=i.useMemo(()=>{if(!r)return;const d=n.findIndex(m=>m.id===r.id);return d===-1?void 0:n[d+1]},[r,n]),U=d=>{if(!C.current||!h.current||!k.current)return;const m=C.current.getBoundingClientRect(),g=(d-m.left)/m.width*100,S=Math.max(0,Math.min(100,Math.round(g)));k.current.style.cssText=`right: ${100-S}%`,r?.duration&&(h.current.currentTime=r.duration*S/100)},Ie=d=>{U(d.clientX)},He=d=>{_.current=!0,U(d.clientX)},Be=d=>{_.current&&U(d.clientX)},se=()=>{_.current=!1},H=i.useCallback(()=>{if(n.length>0){for(let d=0;d<n.length;d++)if(n[d].id===r?.id){n[d+1]&&(t(ce(n[d+1])),h.current?.play());break}}},[n,r,t]),V=i.useCallback(()=>{if(n.length>0){for(let d=0;d<n.length;d++)if(n[d].id===r?.id){n[d-1]&&(t(ce(n[d-1])),h.current?.play());break}}},[n,r,t]),W=i.useCallback(async()=>{h.current&&(s&&!h.current.paused?(t(R(!1)),h.current.pause()):!s&&h.current.paused&&(t(R(!0)),await h.current.play()))},[s,t]),Fe=()=>{h.current&&h.current.play()},Oe=()=>{h.current&&(h.current.currentTime=0,h.current.play())},qe=()=>{let d;const m=h.current;if(!m?.src)return;const g=()=>{L.current.innerText=ue(Math.floor(m.currentTime));let We=Math.round(m.currentTime/r.duration*1e4)/100;k.current&&(k.current.style.cssText=`right: ${100-We}%`),d=requestAnimationFrame(g)},S=()=>d=requestAnimationFrame(g),K=()=>cancelAnimationFrame(d),ne=()=>{K(),w.current?Fe():b.current>0?b.current===1?Oe():H():(t(R(!1)),m.pause())};return m.addEventListener("play",S),m.addEventListener("pause",K),m.addEventListener("ended",ne),()=>{m.removeEventListener("play",S),m.removeEventListener("pause",K),m.removeEventListener("ended",ne),cancelAnimationFrame(d)}},Ue=()=>{v(!1),h.current?.play().then(d=>t(R(!0))).catch(d=>console.log("Auto play was prevented because user didnt interact with the document"))},Ve=async()=>{if(t(R(!1)),L.current&&(L.current.innerText="00:00"),k.current&&(k.current.style.cssText="right: 100%"),r?.stream){v(!0),await Da(r.id)||await $a(r.id,r.stream);let m=await za(r.id);m&&(h.current=new Audio(m),h.current.load(),h.current.volume=u/100,h.current.oncanplaythrough=Ue,qe())}};return i.useEffect(()=>(Ve(),()=>{h.current&&(h.current.oncanplaythrough=null,h.current.pause(),h.current=null)}),[r]),i.useEffect(()=>{const d=g=>{if(g.code==="Space"&&g.target instanceof HTMLElement){const S=g.target.tagName.toLowerCase();if(S==="input"||S==="textarea"||g.target.isContentEditable)return;g.preventDefault(),W()}},m=g=>{if((g.code==="ArrowLeft"||g.code==="ArrowRight")&&g.target instanceof HTMLElement){const S=g.target.tagName.toLowerCase();if(S==="input"||S==="textarea"||g.target.isContentEditable)return;g.preventDefault(),g.code==="ArrowLeft"&&V(),g.code==="ArrowRight"&&H()}};return globalThis.addEventListener("keydown",d),globalThis.addEventListener("keydown",m),()=>{globalThis.removeEventListener("keydown",d),globalThis.removeEventListener("keydown",m)}},[s,W,V,H]),i.useEffect(()=>{h.current&&(h.current.volume=u/100)},[u]),i.useEffect(()=>{t(o?le():le()),w.current=o},[o]),i.useEffect(()=>{b.current=c},[c]),i.useEffect(()=>{h.current&&h.current.paused&&s&&h.current.play(),h.current&&!h.current.paused&&!s&&h.current.pause()},[s]),e.jsx("div",{className:"fixed w-full z-20 h-24 content-center bg-main-400 select-none border-t border-main-500/20 shadow-up",children:e.jsxs("div",{className:"flex justify-between px-4",children:[e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex",children:[e.jsx(de.LazyLoadImage,{src:r?.thumbnail,effect:"blur",alt:"thumbnail",className:"w-16 h-16 object-cover"}),e.jsxs("div",{children:[e.jsx(N,{className:"font-semibold text-gray-600 line-clamp-2 text-ellipsis max-w-40",children:r?.title}),e.jsx(N,{className:"text-gray-500 line-clamp-2 text-ellipsis max-w-40 m-0 lg:text-xs",children:r?.artistNames})]}),e.jsx(jt,{size:20}),e.jsx(yt,{size:20})]}),e.jsxs("div",{className:"flex flex-1 items-center gap-4 flex-col",children:[e.jsxs("div",{className:"flex gap-8 items-center",children:[e.jsxs(X,{children:[e.jsx(G,{asChild:!0,className:`cursor-pointer ${o&&"text-purple-600"}`,onClick:()=>l(d=>!d),children:e.jsx(Zt,{size:20})}),e.jsx(Y,{children:"Bật phát ngẫu nhiên"})]}),e.jsx("span",{className:`${n.length?"cursor-pointer":"text-gray-500"}`,children:e.jsx(Qt,{size:20,onClick:V})}),e.jsx("span",{onClick:W,className:"hover:text-main-500",children:x?e.jsx(ge,{strokeColor:"#0E8080",width:42,height:42}):s?e.jsx(Ht,{size:42}):e.jsx(wt,{size:42})}),e.jsxs(X,{children:[e.jsx(G,{asChild:!0,children:e.jsx("span",{className:`${n.length?"cursor-pointer":"text-gray-500"}`,children:e.jsx(ta,{size:20,onClick:H})})}),E&&e.jsxs(Y,{children:[e.jsx(N,{className:"font-semibold",children:"Phát tiếp theo"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(de.LazyLoadImage,{src:E.thumbnail,effect:"blur",alt:"thumbnail",className:"w-10 h-10 object-cover rounded-md"}),e.jsxs("div",{children:[e.jsx(N,{className:"m-0 text-gray-400",children:E.title}),e.jsx(N,{className:"m-0 text-gray-400",children:E.artistNames})]})]})]})]}),e.jsxs(X,{children:[e.jsx(G,{asChild:!0,className:`cursor-pointer ${c&&"text-purple-600"}`,onClick:()=>f(c===2?0:c+1),children:c===1?e.jsx(Vt,{size:20}):e.jsx(Kt,{size:20})}),e.jsx(Y,{children:"Phát lại tất cả bài hát"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-3 text-sm",children:[e.jsx(N,{ref:L,className:"font-semibold text-gray-500 m-0",children:"00:00"}),e.jsx("div",{className:"relative h-1 hover:h-2 bg-[#0000001a] w-3/5 rounded-full cursor-pointer",onClick:Ie,onMouseDown:He,onMouseMove:Be,onMouseUp:se,onMouseLeave:se,ref:C,children:e.jsx("div",{ref:k,className:"absolute top-0 left-0 bottom-0 h-full bg-main-500 rounded-full"})}),e.jsx(N,{className:"font-semibold text-gray-500 m-0",children:ue(r?.duration??0)})]})]}),e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex justify-end",children:[e.jsx(Wa,{drawerTrigger:e.jsx(Ft,{size:20}),audioRef:h}),e.jsx(B,{size:"icon-lg",variant:"ghost",onClick:()=>p(u===0?50:0),children:u>=50?e.jsx(la,{}):u===0?e.jsx(ua,{}):e.jsx(ia,{})}),e.jsx("input",{type:"range",step:1,min:0,max:100,onChange:d=>p(Number(d.target.value)),value:u,className:"h-1 hover:h-2"}),e.jsx(B,{className:"text-white",size:"lg",onClick:()=>t(kt(!a)),children:e.jsx(bt,{})})]})]})})},Xa=()=>{const{translate:t}=O(),a=ke(),[r,s]=i.useState(""),n=o=>{o.code==="Enter"&&o.currentTarget.value.length>2&&a({pathname:"search/all",search:"?q="+o.currentTarget.value})};return e.jsx("div",{className:"max-w-[440px] w-full",children:e.jsx("div",{className:"bg-[#ffffff54] text-gray-500 rounded-3xl py-2",children:e.jsxs("div",{className:"flex w-full",children:[e.jsx("div",{className:"pl-4 self-center",children:e.jsx(Nt,{})}),e.jsx("input",{type:"text",className:"outline-none px-4 w-full bg-transparent",placeholder:t("search_placeholder"),onKeyUp:o=>n(o),onChange:o=>{s(o.target.value)},value:r}),e.jsx("div",{className:`${r?"block":"hidden"} self-center pr-4`,onClick:()=>s(""),children:e.jsx(me,{})})]})})})};function Ga(t,a=[]){let r=[];function s(o,l){const c=i.createContext(l);c.displayName=o+"Context";const f=r.length;r=[...r,l];const u=x=>{const{scope:v,children:w,...b}=x,k=v?.[t]?.[f]||c,C=i.useMemo(()=>b,Object.values(b));return e.jsx(k.Provider,{value:C,children:w})};u.displayName=o+"Provider";function p(x,v){const w=v?.[t]?.[f]||c,b=i.useContext(w);if(b)return b;if(l!==void 0)return l;throw new Error(`\`${x}\` must be used within \`${o}\``)}return[u,p]}const n=()=>{const o=r.map(l=>i.createContext(l));return function(c){const f=c?.[t]||o;return i.useMemo(()=>({[`__scope${t}`]:{...c,[t]:f}}),[c,f])}};return n.scopeName=t,[s,Ya(n,...a)]}function Ya(...t){const a=t[0];if(t.length===1)return a;const r=()=>{const s=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const l=s.reduce((c,{useScope:f,scopeName:u})=>{const x=f(o)[`__scope${u}`];return{...c,...x}},{});return i.useMemo(()=>({[`__scope${a.scopeName}`]:l}),[l])}};return r.scopeName=a.scopeName,r}var Za=Symbol.for("react.lazy"),F=Pt[" use ".trim().toString()];function Ja(t){return typeof t=="object"&&t!==null&&"then"in t}function Le(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Za&&"_payload"in t&&Ja(t._payload)}function Qa(t){const a=er(t),r=i.forwardRef((s,n)=>{let{children:o,...l}=s;Le(o)&&typeof F=="function"&&(o=F(o._payload));const c=i.Children.toArray(o),f=c.find(ar);if(f){const u=f.props.children,p=c.map(x=>x===f?i.Children.count(u)>1?i.Children.only(null):i.isValidElement(u)?u.props.children:null:x);return e.jsx(a,{...l,ref:n,children:i.isValidElement(u)?i.cloneElement(u,void 0,p):null})}return e.jsx(a,{...l,ref:n,children:o})});return r.displayName=`${t}.Slot`,r}function er(t){const a=i.forwardRef((r,s)=>{let{children:n,...o}=r;if(Le(n)&&typeof F=="function"&&(n=F(n._payload)),i.isValidElement(n)){const l=sr(n),c=rr(o,n.props);return n.type!==i.Fragment&&(c.ref=s?st(s,l):l),i.cloneElement(n,c)}return i.Children.count(n)>1?i.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var tr=Symbol("radix.slottable");function ar(t){return i.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===tr}function rr(t,a){const r={...a};for(const s in a){const n=t[s],o=a[s];/^on[A-Z]/.test(s)?n&&o?r[s]=(...c)=>{const f=o(...c);return n(...c),f}:n&&(r[s]=n):s==="style"?r[s]={...n,...o}:s==="className"&&(r[s]=[n,o].filter(Boolean).join(" "))}return{...t,...r}}function sr(t){let a=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=a&&"isReactWarning"in a&&a.isReactWarning;return r?t.ref:(a=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=a&&"isReactWarning"in a&&a.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var nr=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ae=nr.reduce((t,a)=>{const r=Qa(`Primitive.${a}`),s=i.forwardRef((n,o)=>{const{asChild:l,...c}=n,f=l?r:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...c,ref:o})});return s.displayName=`Primitive.${a}`,{...t,[a]:s}},{});function or(){return St.useSyncExternalStore(ir,()=>!0,()=>!1)}function ir(){return()=>{}}var re="Avatar",[cr]=Ga(re),[lr,Ee]=cr(re),Pe=i.forwardRef((t,a)=>{const{__scopeAvatar:r,...s}=t,[n,o]=i.useState("idle");return e.jsx(lr,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:e.jsx(ae.span,{...s,ref:a})})});Pe.displayName=re;var Ae="AvatarImage",Re=i.forwardRef((t,a)=>{const{__scopeAvatar:r,src:s,onLoadingStatusChange:n=()=>{},...o}=t,l=Ee(Ae,r),c=dr(s,o),f=nt(u=>{n(u),l.onImageLoadingStatusChange(u)});return Q(()=>{c!=="idle"&&f(c)},[c,f]),c==="loaded"?e.jsx(ae.img,{...o,ref:a,src:s}):null});Re.displayName=Ae;var Te="AvatarFallback",$e=i.forwardRef((t,a)=>{const{__scopeAvatar:r,delayMs:s,...n}=t,o=Ee(Te,r),[l,c]=i.useState(s===void 0);return i.useEffect(()=>{if(s!==void 0){const f=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(f)}},[s]),l&&o.imageLoadingStatus!=="loaded"?e.jsx(ae.span,{...n,ref:a}):null});$e.displayName=Te;function he(t,a){return t?a?(t.src!==a&&(t.src=a),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function dr(t,{referrerPolicy:a,crossOrigin:r}){const s=or(),n=i.useRef(null),o=s?(n.current||(n.current=new window.Image),n.current):null,[l,c]=i.useState(()=>he(o,t));return Q(()=>{c(he(o,t))},[o,t]),Q(()=>{const f=x=>()=>{c(x)};if(!o)return;const u=f("loaded"),p=f("error");return o.addEventListener("load",u),o.addEventListener("error",p),a&&(o.referrerPolicy=a),typeof r=="string"&&(o.crossOrigin=r),()=>{o.removeEventListener("load",u),o.removeEventListener("error",p)}},[o,r,a]),l}var ur=Pe,hr=Re,fr=$e;function De({className:t,...a}){return e.jsx(ur,{"data-slot":"avatar",className:j("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...a})}function ze({className:t,...a}){return e.jsx(hr,{"data-slot":"avatar-image",className:j("aspect-square size-full",t),...a})}function pr({className:t,...a}){return e.jsx(fr,{"data-slot":"avatar-fallback",className:j("bg-muted flex size-full items-center justify-center rounded-full",t),...a})}const xr=()=>{const{user:t,signout:a}=ee(),{translate:r}=O();return e.jsxs(je,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(De,{children:t?.avatar?e.jsx(ze,{src:t?.avatar,alt:t?.id}):e.jsx(pr,{children:t?.fullname.charAt(0)})})}),e.jsxs(we,{className:"w-56 z-100",align:"end",children:[e.jsx(Ct,{children:r("my_account")}),e.jsxs(be,{children:[e.jsxs(A,{children:[e.jsx(D,{to:T.UPLOAD_MUSIC,children:r("profile")}),e.jsx($,{children:e.jsx(_t,{})})]}),e.jsxs(A,{children:[e.jsx(D,{to:T.UPLOAD_MUSIC,children:r("settings")}),e.jsx($,{children:e.jsx(Gt,{})})]}),e.jsxs(A,{children:[e.jsx(D,{to:T.UPLOAD_MUSIC,children:r("upload_music")}),e.jsx($,{children:e.jsx(na,{})})]}),e.jsxs(A,{children:[e.jsx(D,{to:T.ADD_ARTIST,children:r("add_artist")}),e.jsx($,{children:e.jsx(ra,{})})]})]}),e.jsx(Mt,{}),e.jsx(A,{onClick:a,children:r("logout")})]})]})},mr=()=>{const{onChangeLang:t,currentLang:a,allLangs:r}=O();return e.jsxs(je,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(De,{className:"rounded-sm",children:e.jsx(ze,{src:a.icon,alt:a.value})})}),e.jsx(we,{className:"w-56 z-100",align:"end",children:e.jsx(be,{children:r.map(s=>e.jsxs(A,{onClick:()=>t(s.value),children:[e.jsx(N,{children:s.label}),e.jsx($,{children:e.jsx("img",{src:s.icon,alt:s.value})})]},s.value))})})]})},gr=()=>{const t=ke(),{isAuthenticated:a}=ee();return e.jsxs("div",{className:"w-full flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex my-2 gap-2 flex-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx($t,{onClick:()=>t(-1),className:"cursor-pointer"}),e.jsx(zt,{onClick:()=>t(1),className:"cursor-pointer"})]}),e.jsx(Xa,{})]}),e.jsx(mr,{}),a?e.jsx(xr,{}):e.jsx(D,{to:T.SIGNIN,className:"flex-none",children:e.jsx(N,{variant:"span",className:"text-white",children:"Đăng nhập"})})]})},br=()=>{const{showSideBarRight:t,scrollTop:a}=z(l=>l.app),{currentSong:r}=z(l=>l.music),s=At(),n=ve(),o=l=>{s.pathname.includes("/artist")||s.pathname.includes("/zing-chart")?l.currentTarget.scrollTop===0?n(Z(!0)):n(Z(!1)):n(Z(!1))};return e.jsxs("div",{className:`w-full bg-main-300 ${r?"h-[calc(100vh-96px)]":"h-screen"}`,children:[e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx(Aa,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[e.jsx("div",{className:`fixed top-0 right-0 left-0 z-100 transition-all duration-1500 ease-in-out sm:left-20 lg:left-48 flex-none backdrop-blur-md px-4 md:px-8 ${t&&"xl:right-[330px]"} ${a?"bg-transparent":"bg-[#969696cc]"}`,children:e.jsx(gr,{})}),e.jsx("div",{className:`flex-auto overflow-y-scroll scroll-smooth transition-all duration-1500 ease-in-out ${t&&"xl:mr-[330px] mr-0"}`,onScroll:o,children:e.jsx("div",{className:"px-4 md:px-8 mt-20 mb-6",children:e.jsx(Rt,{})})})]}),e.jsx(Lt,{})]}),r&&e.jsx(Ka,{})]})};export{br as default};
