import{c as k,j as e,R as Ue,T as Ve,C as We,a as b,b as me,X as ge,d as Ke,D as Xe,P as Ge,O as Ye,u as ve,e as Ze,f as Je,g as ye,h as Qe,i as et,k as tt,l as rt,L as at,m as nt,n as st,o as ie,p as ot,q as it,F as ct,r as ce,B as H,s as je,t as lt,v as dt,w as te,x as S,y as ut,z as ht,A as _,E as A,G as ft,H as we,I as le,J as P,K as de,M as ue,N as pt,Q as xt,S as W,U as K,V as X,W as mt,Y as he,Z as gt,_ as vt,$ as yt,a0 as jt,a1 as wt,a2 as ee,a3 as bt,a4 as kt,a5 as St,a6 as Nt,a7 as Ct,a8 as D,a9 as z,aa as G,ab as Et,ac as _t,ad as Mt,ae as Y}from"./index-V9iyrKZ0.js";import{a as i,N as Lt,R,u as be,d as Rt,r as Pt,L as I,h as At,O as Tt}from"./react-CXKqYdB0.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Dt=k("arrow-left",$t);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],It=k("arrow-right",zt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],Bt=k("circle-pause",Ht);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]],qt=k("mic-vocal",Ft);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ut=k("plus",Ot);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]],Wt=k("repeat-1",Vt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Xt=k("repeat",Kt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Yt=k("settings",Gt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],Jt=k("shuffle",Zt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],er=k("skip-back",Qt);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],rr=k("skip-forward",tr);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],nr=k("upload",ar);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]],or=k("volume-1",sr);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],cr=k("volume-2",ir);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],dr=k("volume-x",lr);function ur({...t}){return e.jsx(Ue,{"data-slot":"dialog",...t})}function hr({...t}){return e.jsx(Ve,{"data-slot":"dialog-trigger",...t})}function fr({...t}){return e.jsx(Ge,{"data-slot":"dialog-portal",...t})}function pr({...t}){return e.jsx(me,{"data-slot":"dialog-close",...t})}function xr({className:t,...r}){return e.jsx(Ye,{"data-slot":"dialog-overlay",className:b("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function mr({className:t,children:r,showCloseButton:a=!0,...s}){return e.jsxs(fr,{"data-slot":"dialog-portal",children:[e.jsx(xr,{}),e.jsxs(We,{"data-slot":"dialog-content",className:b("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s,children:[r,a&&e.jsxs(me,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(ge,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function gr({className:t,...r}){return e.jsx("div",{"data-slot":"dialog-header",className:b("flex flex-col gap-2 text-center sm:text-left",t),...r})}function vr({className:t,...r}){return e.jsx("div",{"data-slot":"dialog-footer",className:b("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function yr({className:t,...r}){return e.jsx(Ke,{"data-slot":"dialog-title",className:b("text-lg leading-none font-semibold",t),...r})}function jr({className:t,...r}){return e.jsx(Xe,{"data-slot":"dialog-description",className:b("text-muted-foreground text-sm",t),...r})}function wr(t){const r=i.useRef({value:t,previous:t});return i.useMemo(()=>(r.current.value!==t&&(r.current.previous=r.current.value,r.current.value=t),r.current.previous),[t])}var F="Switch",[br]=Je(F),[kr,Sr]=br(F),ke=i.forwardRef((t,r)=>{const{__scopeSwitch:a,name:s,checked:n,defaultChecked:o,required:l,disabled:c,value:d="on",onCheckedChange:h,form:m,...f}=t,[x,v]=i.useState(null),j=ve(r,E=>v(E)),g=i.useRef(!1),N=x?m||!!x.closest("form"):!0,[p,M]=Ze({prop:n,defaultProp:o??!1,onChange:h,caller:F});return e.jsxs(kr,{scope:a,checked:p,disabled:c,children:[e.jsx(ye.button,{type:"button",role:"switch","aria-checked":p,"aria-required":l,"data-state":Ee(p),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:j,onClick:Qe(t.onClick,E=>{M(L=>!L),N&&(g.current=E.isPropagationStopped(),g.current||E.stopPropagation())})}),N&&e.jsx(Ce,{control:x,bubbles:!g.current,name:s,value:d,checked:p,required:l,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});ke.displayName=F;var Se="SwitchThumb",Ne=i.forwardRef((t,r)=>{const{__scopeSwitch:a,...s}=t,n=Sr(Se,a);return e.jsx(ye.span,{"data-state":Ee(n.checked),"data-disabled":n.disabled?"":void 0,...s,ref:r})});Ne.displayName=Se;var Nr="SwitchBubbleInput",Ce=i.forwardRef(({__scopeSwitch:t,control:r,checked:a,bubbles:s=!0,...n},o)=>{const l=i.useRef(null),c=ve(l,o),d=wr(a),h=et(r);return i.useEffect(()=>{const m=l.current;if(!m)return;const f=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(f,"checked").set;if(d!==a&&v){const j=new Event("click",{bubbles:s});v.call(m,a),m.dispatchEvent(j)}},[d,a,s]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...n,tabIndex:-1,ref:c,style:{...n.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ce.displayName=Nr;function Ee(t){return t?"checked":"unchecked"}var Cr=ke,Er=Ne;function _r({className:t,...r}){return e.jsx(Cr,{"data-slot":"switch",className:b("peer data-[state=checked]:bg-main-500 data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(Er,{"data-slot":"switch-thumb",className:b("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Mr({name:t,label:r,helperText:a,disabled:s,className:n}){const{control:o}=tt();return e.jsx(rt,{name:t,control:o,render:({field:l,fieldState:{error:c}})=>e.jsxs("div",{className:n,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_r,{id:t,checked:l.value,onCheckedChange:l.onChange,disabled:s}),r&&e.jsx(at,{htmlFor:t,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:r})]}),(a||c)&&e.jsx("p",{className:`mt-1 text-sm ${c?"text-destructive":"text-muted-foreground"}`,children:c?c.message:a})]})})}const Lr=({triggerElement:t})=>{const{enqueueSnackbar:r}=nt(),[a,s]=i.useState(!1),n=st().shape({isPrivate:ot().required("Privacy setting is required"),title:ie().required("Title is required"),description:ie().optional()}),o={isPrivate:!0},l=it({resolver:lt(n),defaultValues:o}),{handleSubmit:c,reset:d,formState:{isSubmitting:h}}=l,m=async f=>{try{const x=new FormData;Object.entries(f).forEach(([j,g])=>x.append(j,g));const v=await dt(x);v?.statusCode&&v?.statusCode===201?(s(!1),d(),r(v.message,{variant:"success"})):r("Có lỗi xảy ra khi tạo danh sách phát",{variant:"error"})}catch(x){console.error(x)}};return e.jsxs(ur,{open:a,onOpenChange:s,children:[e.jsx(hr,{asChild:!0,children:t}),e.jsx(mr,{className:"sm:max-w-md",children:e.jsxs(ct,{methods:l,onSubmit:c(m),children:[e.jsxs(gr,{children:[e.jsx(yr,{children:"Tạo danh sách phát"}),e.jsx(jr,{children:"Nhập thông tin danh sách phát của bạn bên dưới."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ce,{name:"title",fieldLabel:"Tiêu đề",placeholder:"Nhập tiêu đề"}),e.jsx(ce,{name:"description",fieldLabel:"Mô tả",placeholder:"Nhập mô tả"}),e.jsx(Mr,{name:"isPrivate",label:"Riêng tư",helperText:"Đặt chế độ riêng tư"})]}),e.jsxs(vr,{children:[e.jsx(pr,{asChild:!0,children:e.jsx(H,{variant:"outline",children:"Hủy"})}),e.jsx(H,{type:"submit",disabled:h,children:h?e.jsx(je,{strokeColor:"white"}):"Tạo"})]})]})})]})},Rr=()=>{const{isAuthenticated:t}=te();return e.jsx("div",{className:"sm:block hidden lg:w-48 w-20 flex-none border bg-main-200 transition-all duration-1500 ease-in-out",children:e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"w-full h-16 py-4 px-6 flex justify-start items-center gap-1",children:[e.jsx("img",{src:"/vite.svg",alt:"logo"}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(S,{className:"m-0 font-semibold",children:"Tiến's MP3"})})]}),e.jsx("div",{className:"flex flex-col",children:ut.map(r=>e.jsxs(Lt,{to:r.path,className:({isActive:a})=>b("text-gray-500 text-sm py-2 px-6 font-bold flex gap-3 items-center justify-start",a&&"text-[#0F7070] bg-main-100"),children:[r.icon,e.jsx(S,{className:"hidden lg:inline m-0",children:r.text})]},r.path))}),t&&e.jsx(Lr,{triggerElement:e.jsxs("div",{className:"text-gray-500 text-sm py-2 px-6 font-bold flex gap-3 items-center justify-start absolute bottom-0 border-t border-gray-400 w-full",children:[e.jsx(Ut,{}),e.jsx(S,{className:"hidden lg:inline m-0",children:"Tạo playlist"})]})})]})})},Pr="music-player-audio",T="audio-files",Ar=1;let Z=null;const re=async()=>(Z||(Z=ht(Pr,Ar,{upgrade(t){t.objectStoreNames.contains(T)||t.createObjectStore(T)}})),Z),Tr=async(t,r)=>{try{const a=await fetch(r);if(!a.ok)throw new Error(`Failed to fetch audio: ${a.statusText}`);const s=await a.blob();return await(await re()).put(T,{songId:t,blob:s,url:r,cachedAt:Date.now()},t),console.log(`Audio cached successfully for song: ${t}`),!0}catch(a){return console.error(`Error caching audio for song ${t}:`,a),!1}},$r=async t=>{try{return!!await(await re()).get(T,t)}catch(r){return console.error(`Error checking cache for song ${t}:`,r),!1}},Dr=async t=>{try{const a=await(await re()).get(T,t);if(a){const s=URL.createObjectURL(a.blob);return console.log(`Audio retrieved from cache for song: ${t}`),s}return null}catch(r){return console.error(`Error retrieving audio from cache for song ${t}:`,r),null}};function zr({...t}){return e.jsx(_.Root,{"data-slot":"drawer",...t})}function Ir({...t}){return e.jsx(_.Trigger,{"data-slot":"drawer-trigger",...t})}function Hr({...t}){return e.jsx(_.Portal,{"data-slot":"drawer-portal",...t})}function Br({className:t,...r}){return e.jsx(_.Overlay,{"data-slot":"drawer-overlay",className:b("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function Fr({className:t,children:r,...a}){return e.jsxs(Hr,{"data-slot":"drawer-portal",children:[e.jsx(Br,{}),e.jsxs(_.Content,{"data-slot":"drawer-content",className:b("group/drawer-content bg-background fixed z-50 flex h-auto flex-col ","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...a,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),r]})]})}function qr({className:t,...r}){return e.jsx("div",{"data-slot":"drawer-header",className:b("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...r})}function Or({className:t,...r}){return e.jsx(_.Title,{"data-slot":"drawer-title",className:b("text-foreground font-semibold",t),...r})}function Ur({className:t,...r}){return e.jsx(_.Description,{"data-slot":"drawer-description",className:b("text-muted-foreground text-sm",t),...r})}const Vr=({drawerTrigger:t,audioRef:r})=>{const{currentSong:a}=A(h=>h.music),[s,n]=R.useState(""),[o,l]=R.useState(0),c=R.useRef(null),d=R.useRef(null);return R.useEffect(()=>{if((async()=>{if(a?.lyricsFile){const f=await(await fetch(a.lyricsFile)).text();n(f.replace(/\r\n/g,`
`))}})(),r.current){const m=setInterval(()=>{r.current&&l(r.current.currentTime*1e3)},1500);return()=>clearInterval(m)}},[r.current]),R.useEffect(()=>{if(c.current&&d.current){const h=c.current.clientHeight,m=c.current.offsetTop,f=c.current.clientHeight,x=m-h/2-f/2;d.current.scrollTo({top:x,behavior:"smooth"})}},[o]),e.jsxs(zr,{children:[e.jsx(Ir,{asChild:!0,children:t}),e.jsx(Fr,{className:"bg-white/70 min-h-[calc(100vh-96px)] backdrop-blur-md",children:e.jsxs("div",{className:"mx-auto w-full h-screen max-w-6xl relative",children:[e.jsxs(qr,{children:[e.jsx(Or,{children:"Lời bài hát"}),e.jsxs(Ur,{children:[a?.title," - ",a?.artistNames]})]}),e.jsx("div",{ref:d,className:"h-[65vh] overflow-auto px-4",children:s.length>0?e.jsx(ft,{lrc:s,currentMillisecond:o,lineRenderer:({index:h,active:m,line:f})=>e.jsx(S,{ref:m?c:null,variant:"h4",className:`my-8 text-center transition-colors duration-300 ${m?"text-main-500":"text-gray-400"}`,children:f.content},h)}):e.jsx(S,{className:"text-center text-gray-400",children:"Không có lời bài hát"})})]})})]})},Wr=()=>{const t=we(),{showSideBarRight:r}=A(u=>u.app),{currentSong:a,isPlaying:s,currentPlaylistSongs:n}=A(u=>u.music),[o,l]=i.useState(!1),[c,d]=i.useState(0),[h,m]=i.useState(50),[f,x]=i.useState(!0),v=i.useRef(!1),j=i.useRef(0),g=i.useRef(null),N=i.useRef(null),p=i.useRef(null),M=i.useRef(null),E=i.useRef(!1),L=i.useMemo(()=>{if(!a)return;const u=n.findIndex(y=>y.id===a.id);return u===-1?void 0:n[u+1]},[a,n]),q=u=>{if(!N.current||!p.current||!g.current)return;const y=N.current.getBoundingClientRect(),w=(u-y.left)/y.width*100,C=Math.max(0,Math.min(100,Math.round(w)));g.current.style.cssText=`right: ${100-C}%`,a?.duration&&(p.current.currentTime=a.duration*C/100)},$e=u=>{q(u.clientX)},De=u=>{E.current=!0,q(u.clientX)},ze=u=>{E.current&&q(u.clientX)},se=()=>{E.current=!1},$=i.useCallback(()=>{if(n.length>0){for(let u=0;u<n.length;u++)if(n[u].id===a?.id){n[u+1]&&(t(le(n[u+1])),p.current?.play());break}}},[n,a,t]),O=i.useCallback(()=>{if(n.length>0){for(let u=0;u<n.length;u++)if(n[u].id===a?.id){n[u-1]&&(t(le(n[u-1])),p.current?.play());break}}},[n,a,t]),U=i.useCallback(async()=>{p.current&&(s&&!p.current.paused?(t(P(!1)),p.current.pause()):!s&&p.current.paused&&(t(P(!0)),await p.current.play()))},[s,t]),Ie=()=>{p.current&&p.current.play()},He=()=>{p.current&&(p.current.currentTime=0,p.current.play())},Be=()=>{let u;const y=p.current;if(!y?.src)return;const w=()=>{M.current.innerText=he(Math.floor(y.currentTime));let Oe=Math.round(y.currentTime/a.duration*1e4)/100;g.current&&(g.current.style.cssText=`right: ${100-Oe}%`),u=requestAnimationFrame(w)},C=()=>u=requestAnimationFrame(w),V=()=>cancelAnimationFrame(u),oe=()=>{V(),v.current?Ie():j.current>0?j.current===1?He():$():(t(P(!1)),y.pause())};return y.addEventListener("play",C),y.addEventListener("pause",V),y.addEventListener("ended",oe),()=>{y.removeEventListener("play",C),y.removeEventListener("pause",V),y.removeEventListener("ended",oe),cancelAnimationFrame(u)}},Fe=()=>{x(!1),p.current?.play().then(u=>t(P(!0))).catch(u=>console.log("Auto play was prevented because user didnt interact with the document"))},qe=async()=>{if(t(P(!1)),M.current&&(M.current.innerText="00:00"),g.current&&(g.current.style.cssText="right: 100%"),a?.stream){x(!0),await $r(a.id)||await Tr(a.id,a.stream);let y=await Dr(a.id);y&&(p.current=new Audio(y),p.current.load(),p.current.volume=h/100,p.current.oncanplaythrough=Fe,Be())}};return i.useEffect(()=>(qe(),()=>{p.current&&(p.current.oncanplaythrough=null,p.current.pause(),p.current=null)}),[a]),i.useEffect(()=>{const u=w=>{if(w.code==="Space"&&w.target instanceof HTMLElement){const C=w.target.tagName.toLowerCase();if(C==="input"||C==="textarea"||w.target.isContentEditable)return;w.preventDefault(),U()}},y=w=>{if((w.code==="ArrowLeft"||w.code==="ArrowRight")&&w.target instanceof HTMLElement){const C=w.target.tagName.toLowerCase();if(C==="input"||C==="textarea"||w.target.isContentEditable)return;w.preventDefault(),w.code==="ArrowLeft"&&O(),w.code==="ArrowRight"&&$()}};return window.addEventListener("keydown",u),window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",u),window.removeEventListener("keydown",y)}},[s,U,O,$]),i.useEffect(()=>{p.current&&(p.current.volume=h/100)},[h]),i.useEffect(()=>{t(o?de():de()),v.current=o},[o]),i.useEffect(()=>{j.current=c},[c]),i.useEffect(()=>{p.current&&p.current.paused&&s&&p.current.play(),p.current&&!p.current.paused&&!s&&p.current.pause()},[s]),e.jsx("div",{className:"fixed w-full z-20 h-24 content-center bg-main-400 select-none border-t border-main-500/20 shadow-up",children:e.jsxs("div",{className:"flex justify-between px-4",children:[e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex",children:[e.jsx(ue.LazyLoadImage,{src:a?.thumbnail,effect:"blur",alt:"thumbnail",className:"w-16 h-16 object-cover"}),e.jsxs("div",{children:[e.jsx(S,{className:"font-semibold text-gray-600 line-clamp-2 text-ellipsis max-w-40",children:a?.title}),e.jsx(S,{className:"text-gray-500 line-clamp-2 text-ellipsis max-w-40 m-0 lg:text-xs",children:a?.artistNames})]}),e.jsx(pt,{size:20}),e.jsx(xt,{size:20})]}),e.jsxs("div",{className:"flex flex-1 items-center gap-4 flex-col",children:[e.jsxs("div",{className:"flex gap-8 items-center",children:[e.jsxs(W,{children:[e.jsx(K,{asChild:!0,className:`cursor-pointer ${o&&"text-purple-600"}`,onClick:()=>l(u=>!u),children:e.jsx(Jt,{size:20})}),e.jsx(X,{children:"Bật phát ngẫu nhiên"})]}),e.jsx("span",{className:`${n.length?"cursor-pointer":"text-gray-500"}`,children:e.jsx(er,{size:20,onClick:O})}),e.jsx("span",{onClick:U,className:"hover:text-main-500",children:f?e.jsx(je,{strokeColor:"#0E8080",width:42,height:42}):s?e.jsx(Bt,{size:42}):e.jsx(mt,{size:42})}),e.jsxs(W,{children:[e.jsx(K,{asChild:!0,children:e.jsx("span",{className:`${n.length?"cursor-pointer":"text-gray-500"}`,children:e.jsx(rr,{size:20,onClick:$})})}),L&&e.jsxs(X,{children:[e.jsx(S,{className:"font-semibold",children:"Phát tiếp theo"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ue.LazyLoadImage,{src:L.thumbnail,effect:"blur",alt:"thumbnail",className:"w-10 h-10 object-cover rounded-md"}),e.jsxs("div",{children:[e.jsx(S,{className:"m-0 text-gray-400",children:L.title}),e.jsx(S,{className:"m-0 text-gray-400",children:L.artistNames})]})]})]})]}),e.jsxs(W,{children:[e.jsx(K,{asChild:!0,className:`cursor-pointer ${c&&"text-purple-600"}`,onClick:()=>d(c===2?0:c+1),children:c===1?e.jsx(Wt,{size:20}):e.jsx(Xt,{size:20})}),e.jsx(X,{children:"Phát lại tất cả bài hát"})]})]}),e.jsxs("div",{className:"w-full flex items-center justify-center gap-3 text-sm",children:[e.jsx(S,{ref:M,className:"font-semibold text-gray-500 m-0",children:"00:00"}),e.jsx("div",{className:"relative h-1 hover:h-2 bg-[#0000001a] w-3/5 rounded-full cursor-pointer",onClick:$e,onMouseDown:De,onMouseMove:ze,onMouseUp:se,onMouseLeave:se,ref:N,children:e.jsx("div",{ref:g,className:"absolute top-0 left-0 bottom-0 h-full bg-main-500 rounded-full"})}),e.jsx(S,{className:"font-semibold text-gray-500 m-0",children:he(a?.duration??0)})]})]}),e.jsxs("div",{className:"flex-1 items-center gap-4 hidden md:flex justify-end",children:[e.jsx(Vr,{drawerTrigger:e.jsx(qt,{size:20}),audioRef:p}),e.jsx(H,{size:"icon-lg",variant:"ghost",onClick:()=>m(h===0?50:0),children:h>=50?e.jsx(cr,{}):h===0?e.jsx(dr,{}):e.jsx(or,{})}),e.jsx("input",{type:"range",step:1,min:0,max:100,onChange:u=>m(Number(u.target.value)),value:h,className:"h-1 hover:h-2"}),e.jsx(H,{className:"text-white",size:"lg",onClick:()=>t(vt(!r)),children:e.jsx(gt,{})})]})]})})},Kr=()=>{const t=be(),[r,a]=i.useState(""),s=n=>{n.code==="Enter"&&n.currentTarget.value.length>2&&t({pathname:"search/all",search:"?q="+n.currentTarget.value})};return e.jsx("div",{className:"max-w-[440px] w-full",children:e.jsx("div",{className:"bg-[#ffffff54] text-gray-500 rounded-3xl py-2",children:e.jsxs("div",{className:"flex w-full",children:[e.jsx("div",{className:"pl-4 self-center",children:e.jsx(yt,{})}),e.jsx("input",{type:"text",className:"outline-none px-4 w-full bg-transparent",placeholder:"Tìm kiếm bài hát, nghệ sĩ, lời bài hát",onKeyUp:n=>s(n),onChange:n=>{a(n.target.value)},value:r}),e.jsx("div",{className:`${r?"block":"hidden"} self-center pr-4`,onClick:()=>a(""),children:e.jsx(ge,{})})]})})})};function Xr(t,r=[]){let a=[];function s(o,l){const c=i.createContext(l);c.displayName=o+"Context";const d=a.length;a=[...a,l];const h=f=>{const{scope:x,children:v,...j}=f,g=x?.[t]?.[d]||c,N=i.useMemo(()=>j,Object.values(j));return e.jsx(g.Provider,{value:N,children:v})};h.displayName=o+"Provider";function m(f,x){const v=x?.[t]?.[d]||c,j=i.useContext(v);if(j)return j;if(l!==void 0)return l;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[h,m]}const n=()=>{const o=a.map(l=>i.createContext(l));return function(c){const d=c?.[t]||o;return i.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return n.scopeName=t,[s,Gr(n,...r)]}function Gr(...t){const r=t[0];if(t.length===1)return r;const a=()=>{const s=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const l=s.reduce((c,{useScope:d,scopeName:h})=>{const f=d(o)[`__scope${h}`];return{...c,...f}},{});return i.useMemo(()=>({[`__scope${r.scopeName}`]:l}),[l])}};return a.scopeName=r.scopeName,a}var Yr=Symbol.for("react.lazy"),B=Rt[" use ".trim().toString()];function Zr(t){return typeof t=="object"&&t!==null&&"then"in t}function _e(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Yr&&"_payload"in t&&Zr(t._payload)}function Jr(t){const r=Qr(t),a=i.forwardRef((s,n)=>{let{children:o,...l}=s;_e(o)&&typeof B=="function"&&(o=B(o._payload));const c=i.Children.toArray(o),d=c.find(ta);if(d){const h=d.props.children,m=c.map(f=>f===d?i.Children.count(h)>1?i.Children.only(null):i.isValidElement(h)?h.props.children:null:f);return e.jsx(r,{...l,ref:n,children:i.isValidElement(h)?i.cloneElement(h,void 0,m):null})}return e.jsx(r,{...l,ref:n,children:o})});return a.displayName=`${t}.Slot`,a}function Qr(t){const r=i.forwardRef((a,s)=>{let{children:n,...o}=a;if(_e(n)&&typeof B=="function"&&(n=B(n._payload)),i.isValidElement(n)){const l=aa(n),c=ra(o,n.props);return n.type!==i.Fragment&&(c.ref=s?jt(s,l):l),i.cloneElement(n,c)}return i.Children.count(n)>1?i.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var ea=Symbol("radix.slottable");function ta(t){return i.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===ea}function ra(t,r){const a={...r};for(const s in r){const n=t[s],o=r[s];/^on[A-Z]/.test(s)?n&&o?a[s]=(...c)=>{const d=o(...c);return n(...c),d}:n&&(a[s]=n):s==="style"?a[s]={...n,...o}:s==="className"&&(a[s]=[n,o].filter(Boolean).join(" "))}return{...t,...a}}function aa(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var na=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ae=na.reduce((t,r)=>{const a=Jr(`Primitive.${r}`),s=i.forwardRef((n,o)=>{const{asChild:l,...c}=n,d=l?a:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:o})});return s.displayName=`Primitive.${r}`,{...t,[r]:s}},{}),J={exports:{}},Q={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fe;function sa(){if(fe)return Q;fe=1;var t=Pt();function r(f,x){return f===x&&(f!==0||1/f===1/x)||f!==f&&x!==x}var a=typeof Object.is=="function"?Object.is:r,s=t.useState,n=t.useEffect,o=t.useLayoutEffect,l=t.useDebugValue;function c(f,x){var v=x(),j=s({inst:{value:v,getSnapshot:x}}),g=j[0].inst,N=j[1];return o(function(){g.value=v,g.getSnapshot=x,d(g)&&N({inst:g})},[f,v,x]),n(function(){return d(g)&&N({inst:g}),f(function(){d(g)&&N({inst:g})})},[f]),l(v),v}function d(f){var x=f.getSnapshot;f=f.value;try{var v=x();return!a(f,v)}catch{return!0}}function h(f,x){return x()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return Q.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:m,Q}var pe;function oa(){return pe||(pe=1,J.exports=sa()),J.exports}var ia=oa();function ca(){return ia.useSyncExternalStore(la,()=>!0,()=>!1)}function la(){return()=>{}}var ne="Avatar",[da]=Xr(ne),[ua,Me]=da(ne),Le=i.forwardRef((t,r)=>{const{__scopeAvatar:a,...s}=t,[n,o]=i.useState("idle");return e.jsx(ua,{scope:a,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:e.jsx(ae.span,{...s,ref:r})})});Le.displayName=ne;var Re="AvatarImage",Pe=i.forwardRef((t,r)=>{const{__scopeAvatar:a,src:s,onLoadingStatusChange:n=()=>{},...o}=t,l=Me(Re,a),c=ha(s,o),d=wt(h=>{n(h),l.onImageLoadingStatusChange(h)});return ee(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?e.jsx(ae.img,{...o,ref:r,src:s}):null});Pe.displayName=Re;var Ae="AvatarFallback",Te=i.forwardRef((t,r)=>{const{__scopeAvatar:a,delayMs:s,...n}=t,o=Me(Ae,a),[l,c]=i.useState(s===void 0);return i.useEffect(()=>{if(s!==void 0){const d=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(d)}},[s]),l&&o.imageLoadingStatus!=="loaded"?e.jsx(ae.span,{...n,ref:r}):null});Te.displayName=Ae;function xe(t,r){return t?r?(t.src!==r&&(t.src=r),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ha(t,{referrerPolicy:r,crossOrigin:a}){const s=ca(),n=i.useRef(null),o=s?(n.current||(n.current=new window.Image),n.current):null,[l,c]=i.useState(()=>xe(o,t));return ee(()=>{c(xe(o,t))},[o,t]),ee(()=>{const d=f=>()=>{c(f)};if(!o)return;const h=d("loaded"),m=d("error");return o.addEventListener("load",h),o.addEventListener("error",m),r&&(o.referrerPolicy=r),typeof a=="string"&&(o.crossOrigin=a),()=>{o.removeEventListener("load",h),o.removeEventListener("error",m)}},[o,a,r]),l}var fa=Le,pa=Pe,xa=Te;function ma({className:t,...r}){return e.jsx(fa,{"data-slot":"avatar",className:b("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...r})}function ga({className:t,...r}){return e.jsx(pa,{"data-slot":"avatar-image",className:b("aspect-square size-full",t),...r})}function va({className:t,...r}){return e.jsx(xa,{"data-slot":"avatar-fallback",className:b("bg-muted flex size-full items-center justify-center rounded-full",t),...r})}const ya=()=>{const{user:t,signout:r}=te();return e.jsxs(bt,{children:[e.jsx(kt,{asChild:!0,children:e.jsx(ma,{children:t?.avatar?e.jsx(ga,{src:t?.avatar,alt:t?.id}):e.jsx(va,{children:t?.fullname.charAt(0)})})}),e.jsxs(St,{className:"w-56 z-100",align:"end",children:[e.jsx(Nt,{children:"Tài khoản của tôi"}),e.jsxs(Ct,{children:[e.jsxs(D,{children:[e.jsx(I,{to:z.UPLOAD_MUSIC,children:"Hồ sơ"}),e.jsx(G,{children:e.jsx(Et,{})})]}),e.jsxs(D,{children:[e.jsx(I,{to:z.UPLOAD_MUSIC,children:"Cài đặt"}),e.jsx(G,{children:e.jsx(Yt,{})})]}),e.jsxs(D,{children:[e.jsx(I,{to:z.UPLOAD_MUSIC,children:"Tải nhạc"}),e.jsx(G,{children:e.jsx(nr,{})})]})]}),e.jsx(_t,{}),e.jsx(D,{onClick:r,children:"Đăng xuất"})]})]})},ja=()=>{const t=be(),{isAuthenticated:r}=te();return e.jsxs("div",{className:"w-full flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex my-2 gap-2 flex-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(Dt,{onClick:()=>t(-1),className:"cursor-pointer"}),e.jsx(It,{onClick:()=>t(1),className:"cursor-pointer"})]}),e.jsx(Kr,{})]}),r?e.jsx(ya,{}):e.jsx(I,{to:z.SIGNIN,className:"flex-none",children:e.jsx(S,{variant:"span",className:"text-white",children:"Đăng nhập"})})]})},ka=()=>{const{showSideBarRight:t,scrollTop:r}=A(l=>l.app),{currentSong:a}=A(l=>l.music),s=At(),n=we(),o=l=>{s.pathname.includes("/artist")||s.pathname.includes("/zing-chart")?l.currentTarget.scrollTop===0?n(Y(!0)):n(Y(!1)):n(Y(!1))};return e.jsxs("div",{className:`w-full bg-main-300 ${a?"h-[calc(100vh-96px)]":"h-screen"}`,children:[e.jsxs("div",{className:"w-full h-full flex",children:[e.jsx(Rr,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative",children:[e.jsx("div",{className:`fixed top-0 right-0 left-0 z-100 transition-all duration-1500 ease-in-out sm:left-20 lg:left-48 flex-none backdrop-blur-md px-4 md:px-8 ${t&&"xl:right-[330px]"} ${r?"bg-transparent":"bg-[#969696cc]"}`,children:e.jsx(ja,{})}),e.jsx("div",{className:`flex-auto overflow-y-scroll scroll-smooth transition-all duration-1500 ease-in-out ${t&&"xl:mr-[330px] mr-0"}`,onScroll:o,children:e.jsx("div",{className:"px-4 md:px-8 mt-20 mb-6",children:e.jsx(Tt,{})})})]}),e.jsx(Mt,{})]}),a&&e.jsx(Wr,{})]})};export{ka as default};
